!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n=e();for(var r in n)("object"==typeof exports?exports:t)[r]=n[r]}}(window,(function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=36)}([function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return s}));var r=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array,s=Math.random;Math.PI;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)})},function(t,e,n){"use strict";var r=n(31);n.d(e,"a",(function(){return r.a})),n.d(e,"b",(function(){return r.b})),n.d(e,"c",(function(){return r.c})),n.d(e,"d",(function(){return r.d})),n.d(e,"e",(function(){return r.e})),n.d(e,"f",(function(){return r.f})),n.d(e,"g",(function(){return r.g})),n.d(e,"h",(function(){return r.h})),n.d(e,"i",(function(){return r.i})),n.d(e,"j",(function(){return r.j})),n.d(e,"k",(function(){return r.k}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return o})),n.d(e,"e",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"f",(function(){return h})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return l}));n(13),n(19),n(24),n(17);var r=1/Math.PI*180,i=1/180*Math.PI,s={};function o(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?s.precision||4:e;return t=function(t){return Math.round(t/s.EPSILON)*s.EPSILON}(t),"".concat(parseFloat(t.toPrecision(n)))}function a(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function u(t,e,n){if(a(t)){n=n||((i=t).clone?i.clone():new Array(i.length));for(var r=0;r<n.length&&r<t.length;++r)n[r]=e(t[r],r,n);return n}var i;return e(t)}function c(t){return function(t,e){return u(t,(function(t){return t*i}),e)}(t)}function h(t){return function(t,e){return u(t,(function(t){return t*r}),e)}(t)}function f(t,e,n){return u(t,(function(t){return Math.max(e,Math.min(n,t))}))}function l(t,e,n){var r=s.EPSILON;n&&(s.EPSILON=n);try{if(t===e)return!0;if(a(t)&&a(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!l(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=s.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{s.EPSILON=r}}s.EPSILON=1e-12,s.debug=!1,s.precision=4,s.printTypes=!1,s.printDegrees=!1,s.printRowMajor=!0},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return s})),n.d(e,"e",(function(){return o})),n.d(e,"h",(function(){return a})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return c})),n.d(e,"m",(function(){return h})),n.d(e,"l",(function(){return f})),n.d(e,"n",(function(){return l})),n.d(e,"i",(function(){return y})),n.d(e,"j",(function(){return d})),n.d(e,"k",(function(){return g})),n.d(e,"a",(function(){return v})),n.d(e,"f",(function(){return m}));var r=n(0);function i(){var t=new r.a(3);return r.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function s(t){var e=t[0],n=t[1],r=t[2];return Math.hypot(e,n,r)}function o(t,e,n){var i=new r.a(3);return i[0]=t,i[1]=e,i[2]=n,i}function a(t,e){var n=e[0],r=e[1],i=e[2],s=n*n+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t}function u(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function c(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],u=n[2];return t[0]=i*u-s*a,t[1]=s*o-r*u,t[2]=r*a-i*o,t}function h(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s+n[15];return o=o||1,t[0]=(n[0]*r+n[4]*i+n[8]*s+n[12])/o,t[1]=(n[1]*r+n[5]*i+n[9]*s+n[13])/o,t[2]=(n[2]*r+n[6]*i+n[10]*s+n[14])/o,t}function f(t,e,n){var r=e[0],i=e[1],s=e[2];return t[0]=r*n[0]+i*n[3]+s*n[6],t[1]=r*n[1]+i*n[4]+s*n[7],t[2]=r*n[2]+i*n[5]+s*n[8],t}function l(t,e,n){var r=n[0],i=n[1],s=n[2],o=n[3],a=e[0],u=e[1],c=e[2],h=i*c-s*u,f=s*a-r*c,l=r*u-i*a,y=i*l-s*f,d=s*h-r*l,g=r*f-i*h,v=2*o;return h*=v,f*=v,l*=v,y*=2,d*=2,g*=2,t[0]=a+h+y,t[1]=u+f+d,t[2]=c+l+g,t}function y(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0],s[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),s[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function d(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),s[1]=i[1],s[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function g(t,e,n,r){var i=[],s=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],s[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),s[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),s[2]=i[2],t[0]=s[0]+n[0],t[1]=s[1]+n[1],t[2]=s[2]+n[2],t}function v(t,e){var n=o(t[0],t[1],t[2]),r=o(e[0],e[1],e[2]);a(n,n),a(r,r);var i=u(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)}var b,m=s;b=i()},function(t,e,n){"use strict";n.d(e,"o",(function(){return i})),n.d(e,"d",(function(){return s})),n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return a})),n.d(e,"n",(function(){return u})),n.d(e,"m",(function(){return c})),n.d(e,"i",(function(){return h})),n.d(e,"j",(function(){return f})),n.d(e,"k",(function(){return l})),n.d(e,"l",(function(){return y})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return g})),n.d(e,"h",(function(){return v})),n.d(e,"g",(function(){return b})),n.d(e,"e",(function(){return m}));var r=n(0);function i(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],s=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=s,t[11]=e[14],t[12]=i,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function s(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],y=e[11],d=e[12],g=e[13],v=e[14],b=e[15],m=n*a-r*o,p=n*u-i*o,E=n*c-s*o,O=r*u-i*a,T=r*c-s*a,w=i*c-s*u,k=h*g-f*d,A=h*v-l*d,S=h*b-y*d,N=f*v-l*g,I=f*b-y*g,L=l*b-y*v,M=m*L-p*I+E*N+O*S-T*A+w*k;return M?(M=1/M,t[0]=(a*L-u*I+c*N)*M,t[1]=(i*I-r*L-s*N)*M,t[2]=(g*w-v*T+b*O)*M,t[3]=(l*T-f*w-y*O)*M,t[4]=(u*S-o*L-c*A)*M,t[5]=(n*L-i*S+s*A)*M,t[6]=(v*E-d*w-b*p)*M,t[7]=(h*w-l*E+y*p)*M,t[8]=(o*I-a*S+c*k)*M,t[9]=(r*S-n*I-s*k)*M,t[10]=(d*T-g*E+b*m)*M,t[11]=(f*E-h*T-y*m)*M,t[12]=(a*A-o*N-u*k)*M,t[13]=(n*N-r*A+i*k)*M,t[14]=(g*p-d*O-v*m)*M,t[15]=(h*O-f*p+l*m)*M,t):null}function o(t){var e=t[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],y=t[12],d=t[13],g=t[14],v=t[15];return(e*o-n*s)*(f*v-l*g)-(e*a-r*s)*(h*v-l*d)+(e*u-i*s)*(h*g-f*d)+(n*a-r*o)*(c*v-l*y)-(n*u-i*o)*(c*g-f*y)+(r*u-i*a)*(c*d-h*y)}function a(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],y=e[10],d=e[11],g=e[12],v=e[13],b=e[14],m=e[15],p=n[0],E=n[1],O=n[2],T=n[3];return t[0]=p*r+E*a+O*f+T*g,t[1]=p*i+E*u+O*l+T*v,t[2]=p*s+E*c+O*y+T*b,t[3]=p*o+E*h+O*d+T*m,p=n[4],E=n[5],O=n[6],T=n[7],t[4]=p*r+E*a+O*f+T*g,t[5]=p*i+E*u+O*l+T*v,t[6]=p*s+E*c+O*y+T*b,t[7]=p*o+E*h+O*d+T*m,p=n[8],E=n[9],O=n[10],T=n[11],t[8]=p*r+E*a+O*f+T*g,t[9]=p*i+E*u+O*l+T*v,t[10]=p*s+E*c+O*y+T*b,t[11]=p*o+E*h+O*d+T*m,p=n[12],E=n[13],O=n[14],T=n[15],t[12]=p*r+E*a+O*f+T*g,t[13]=p*i+E*u+O*l+T*v,t[14]=p*s+E*c+O*y+T*b,t[15]=p*o+E*h+O*d+T*m,t}function u(t,e,n){var r,i,s,o,a,u,c,h,f,l,y,d,g=n[0],v=n[1],b=n[2];return e===t?(t[12]=e[0]*g+e[4]*v+e[8]*b+e[12],t[13]=e[1]*g+e[5]*v+e[9]*b+e[13],t[14]=e[2]*g+e[6]*v+e[10]*b+e[14],t[15]=e[3]*g+e[7]*v+e[11]*b+e[15]):(r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],y=e[10],d=e[11],t[0]=r,t[1]=i,t[2]=s,t[3]=o,t[4]=a,t[5]=u,t[6]=c,t[7]=h,t[8]=f,t[9]=l,t[10]=y,t[11]=d,t[12]=r*g+a*v+f*b+e[12],t[13]=i*g+u*v+l*b+e[13],t[14]=s*g+c*v+y*b+e[14],t[15]=o*g+h*v+d*b+e[15]),t}function c(t,e,n){var r=n[0],i=n[1],s=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function h(t,e,n,i){var s,o,a,u,c,h,f,l,y,d,g,v,b,m,p,E,O,T,w,k,A,S,N,I,L=i[0],M=i[1],j=i[2],_=Math.hypot(L,M,j);return _<r.b?null:(L*=_=1/_,M*=_,j*=_,s=Math.sin(n),a=1-(o=Math.cos(n)),u=e[0],c=e[1],h=e[2],f=e[3],l=e[4],y=e[5],d=e[6],g=e[7],v=e[8],b=e[9],m=e[10],p=e[11],E=L*L*a+o,O=M*L*a+j*s,T=j*L*a-M*s,w=L*M*a-j*s,k=M*M*a+o,A=j*M*a+L*s,S=L*j*a+M*s,N=M*j*a-L*s,I=j*j*a+o,t[0]=u*E+l*O+v*T,t[1]=c*E+y*O+b*T,t[2]=h*E+d*O+m*T,t[3]=f*E+g*O+p*T,t[4]=u*w+l*k+v*A,t[5]=c*w+y*k+b*A,t[6]=h*w+d*k+m*A,t[7]=f*w+g*k+p*A,t[8]=u*S+l*N+v*I,t[9]=c*S+y*N+b*I,t[10]=h*S+d*N+m*I,t[11]=f*S+g*N+p*I,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function f(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[4],o=e[5],a=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*i+c*r,t[5]=o*i+h*r,t[6]=a*i+f*r,t[7]=u*i+l*r,t[8]=c*i-s*r,t[9]=h*i-o*r,t[10]=f*i-a*r,t[11]=l*i-u*r,t}function l(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i-c*r,t[1]=o*i-h*r,t[2]=a*i-f*r,t[3]=u*i-l*r,t[8]=s*r+c*i,t[9]=o*r+h*i,t[10]=a*r+f*i,t[11]=u*r+l*i,t}function y(t,e,n){var r=Math.sin(n),i=Math.cos(n),s=e[0],o=e[1],a=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*i+c*r,t[1]=o*i+h*r,t[2]=a*i+f*r,t[3]=u*i+l*r,t[4]=c*i-s*r,t[5]=h*i-o*r,t[6]=f*i-a*r,t[7]=l*i-u*r,t}function d(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,u=i+i,c=n*o,h=r*o,f=r*a,l=i*o,y=i*a,d=i*u,g=s*o,v=s*a,b=s*u;return t[0]=1-f-d,t[1]=h+b,t[2]=l-v,t[3]=0,t[4]=h-b,t[5]=1-c-d,t[6]=y+g,t[7]=0,t[8]=l+v,t[9]=y-g,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function g(t,e,n,r,i,s,o){var a=1/(n-e),u=1/(i-r),c=1/(s-o);return t[0]=2*s*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*u,t[6]=0,t[7]=0,t[8]=(n+e)*a,t[9]=(i+r)*u,t[10]=(o+s)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*s*2*c,t[15]=0,t}function v(t,e,n,r,i){var s,o=1/Math.tan(e/2);return t[0]=o/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t}function b(t,e,n,r,i,s,o){var a=1/(e-n),u=1/(r-i),c=1/(s-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*a,t[13]=(i+r)*u,t[14]=(o+s)*c,t[15]=1,t}function m(t,e,n,i){var s,o,a,u,c,h,f,l,y,d,g=e[0],v=e[1],b=e[2],m=i[0],p=i[1],E=i[2],O=n[0],T=n[1],w=n[2];return Math.abs(g-O)<r.b&&Math.abs(v-T)<r.b&&Math.abs(b-w)<r.b?function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}(t):(f=g-O,l=v-T,y=b-w,s=p*(y*=d=1/Math.hypot(f,l,y))-E*(l*=d),o=E*(f*=d)-m*y,a=m*l-p*f,(d=Math.hypot(s,o,a))?(s*=d=1/d,o*=d,a*=d):(s=0,o=0,a=0),u=l*a-y*o,c=y*s-f*a,h=f*o-l*s,(d=Math.hypot(u,c,h))?(u*=d=1/d,c*=d,h*=d):(u=0,c=0,h=0),t[0]=s,t[1]=u,t[2]=f,t[3]=0,t[4]=o,t[5]=c,t[6]=l,t[7]=0,t[8]=a,t[9]=h,t[10]=y,t[11]=0,t[12]=-(s*g+o*v+a*b),t[13]=-(u*g+c*v+h*b),t[14]=-(f*g+l*v+y*b),t[15]=1,t)}},function(t,e,n){"use strict";function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a}));var r=n(2);function i(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function s(t,e,n){if(r.b.debug&&!function(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(""|n," some fields set to invalid numbers'"));return t}var o={};function a(t,e){o[t]||(o[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18);function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Object(r.a)(t,e)}},function(t,e,n){"use strict";var r=n(13);function i(t,e){return!e||"object"!==Object(r.a)(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}n.d(e,"a",(function(){return i}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"g",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"l",(function(){return a})),n.d(e,"a",(function(){return u})),n.d(e,"k",(function(){return c})),n.d(e,"h",(function(){return h})),n.d(e,"m",(function(){return f})),n.d(e,"j",(function(){return l})),n.d(e,"d",(function(){return y})),n.d(e,"i",(function(){return d})),n.d(e,"n",(function(){return g})),n.d(e,"o",(function(){return v})),n.d(e,"f",(function(){return b})),n.d(e,"e",(function(){return m}));var r=n(0);function i(t){var e=new r.a(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function s(t,e,n,i){var s=new r.a(4);return s[0]=t,s[1]=e,s[2]=n,s[3]=i,s}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function a(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t}function u(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function c(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.hypot(e,n,r,i)}function f(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}function l(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s;return o>0&&(o=1/Math.sqrt(o)),t[0]=n*o,t[1]=r*o,t[2]=i*o,t[3]=s*o,t}function y(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function d(t,e,n,r){var i=e[0],s=e[1],o=e[2],a=e[3];return t[0]=i+r*(n[0]-i),t[1]=s+r*(n[1]-s),t[2]=o+r*(n[2]-o),t[3]=a+r*(n[3]-a),t}function g(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*s+n[12]*o,t[1]=n[1]*r+n[5]*i+n[9]*s+n[13]*o,t[2]=n[2]*r+n[6]*i+n[10]*s+n[14]*o,t[3]=n[3]*r+n[7]*i+n[11]*s+n[15]*o,t}function v(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[0],a=n[1],u=n[2],c=n[3],h=c*r+a*s-u*i,f=c*i+u*r-o*s,l=c*s+o*i-a*r,y=-o*r-a*i-u*s;return t[0]=h*c+y*-o+f*-u-l*-a,t[1]=f*c+y*-a+l*-o-h*-u,t[2]=l*c+y*-u+h*-a-f*-o,t[3]=e[3],t}function b(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function m(t,e){var n=t[0],i=t[1],s=t[2],o=t[3],a=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-a)<=r.b*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=r.b*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(s-c)<=r.b*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-h)<=r.b*Math.max(1,Math.abs(o),Math.abs(h))}var p,E;p=new r.a(4),r.a!=Float32Array&&(p[0]=0,p[1]=0,p[2]=0,p[3]=0),E=p},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return a}));var r=n(0);function i(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t}function s(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t}function o(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t}function a(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t}var u,c;u=new r.a(2),r.a!=Float32Array&&(u[0]=0,u[1]=0),c=u},function(t,e,n){"use strict";function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e,n){var r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}function i(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}function s(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t[2]=e[2],t}n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return s}))},,,function(t,e,n){"use strict";function r(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";function r(t,e){return(r=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var r=n(18);function i(t,e,n){return(i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var s=new(Function.bind.apply(t,i));return n&&Object(r.a)(s,n.prototype),s}).apply(null,arguments)}},function(t,e,n){"use strict";function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var n=[],r=!0,i=!1,s=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);r=!0);}catch(t){i=!0,s=t}finally{try{r||null==a.return||a.return()}finally{if(i)throw s}}return n}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";(function(t,r){n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return o}));const i={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t,document:"undefined"!=typeof document&&document},s=i.global||i.self||i.window,o="object"!=typeof r||"[object process]"!==String(r)||r.browser,a=void 0!==r&&r.version&&r.version.match(/v([0-9]*)/);a&&parseFloat(a[1])}).call(this,n(27),n(50))},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var r=n(7),i=n(5),s=n(10),o=n(8),a=n(9),u=n(23),c=n(6),h=n(17),f=function(t){function e(){return Object(r.a)(this,e),Object(s.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(a.a)(e,t),Object(i.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return Object(c.a)(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return Object(c.a)(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]*=s[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]/=s[o];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return Object(h.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),Object(c.a)(this[t])}},{key:"setComponent",value:function(t,e){return Object(h.a)(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=Object(c.a)(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=Object(c.a)(t)}}]),e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var r=n(7),i=n(5),s=n(10),o=n(8),a=n(9),u=n(25),c=n(2),h=function(t){function e(){return Object(r.a)(this,e),Object(s.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(a.a)(e,t),Object(i.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"to",value:function(t){return t===this?this:Object(c.e)(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(c.b)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+Object(c.d)(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!Object(c.c)(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]+=s[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]-=s[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"check",value:function(){if(c.b.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"elements",get:function(){return this}}]),e}(Object(u.a)(Array))},function(t,e,n){"use strict";function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}n.d(e,"a",(function(){return r}))},function(t,e,n){"use strict";var r=n(8),i=n(18);var s=n(19);function o(t){var e="function"==typeof Map?new Map:void 0;return(o=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,o)}function o(){return Object(s.a)(t,arguments,Object(r.a)(this).constructor)}return o.prototype=Object.create(t.prototype,{constructor:{value:o,enumerable:!1,writable:!0,configurable:!0}}),Object(i.a)(o,t)})(t)}n.d(e,"a",(function(){return o}))},,function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},,,,function(t,e,n){"use strict";(function(t){var r=n(1),i=n(32);n.d(e,"b",(function(){return i.a}));var s=n(33);n.d(e,"c",(function(){return s.a}));var o=n(35);n.d(e,"a",(function(){return o.a}));var a=n(2);n.d(e,"g",(function(){return a.b})),n.d(e,"i",(function(){return a.e})),n.d(e,"h",(function(){return a.c})),n.d(e,"k",(function(){return a.g})),n.d(e,"j",(function(){return a.f})),n.d(e,"f",(function(){return a.a}));var u=n(34);n.d(e,"d",(function(){return u.a}));var c=n(17);n.d(e,"e",(function(){return c.a}));var h={self:"undefined"!=typeof self&&self,window:"undefined"!=typeof window&&window,global:void 0!==t&&t};(h.global||h.self||h.window).mathgl={config:r.g}}).call(this,n(27))},function(t,e,n){"use strict";n.d(e,"a",(function(){return y}));var r=n(7),i=n(5),s=n(10),o=n(8),a=n(9),u=n(22),c=n(2),h=n(6),f=n(12),l=n(14),y=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.a)(this,e),t=Object(s.a)(this,Object(o.a)(e).call(this,2)),Object(c.e)(n)&&1===arguments.length?t.copy(n):(c.b.debug&&(Object(h.a)(n),Object(h.a)(i)),t[0]=n,t[1]=i),t}return Object(a.a)(e,t),Object(i.a)(e,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this.check()}},{key:"fromObject",value:function(t){return c.b.debug&&(Object(h.a)(t.x),Object(h.a)(t.y)),this[0]=t.x,this[1]=t.y,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t}},{key:"horizontalAngle",value:function(){return Math.atan2(this.y,this.x)}},{key:"verticalAngle",value:function(){return Math.atan2(this.x,this.y)}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return f.d(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(l.a)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return f.c(this,this,t),this.check()}},{key:"transformByMatrix2x3",value:function(t){return f.b(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return f.a(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 2}}]),e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return d}));var r=n(7),i=n(5),s=n(10),o=n(8),a=n(9),u=n(22),c=n(2),h=n(6),f=n(3),l=n(14),y=[0,0,0],d=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(r.a)(this,e),t=Object(s.a)(this,Object(o.a)(e).call(this,-0,-0,-0)),1===arguments.length&&Object(c.e)(n)?t.copy(n):(c.b.debug&&(Object(h.a)(n),Object(h.a)(i),Object(h.a)(a)),t[0]=n,t[1]=i,t[2]=a),t}return Object(a.a)(e,t),Object(i.a)(e,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return c.b.debug&&(Object(h.a)(t.x),Object(h.a)(t.y),Object(h.a)(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"angle",value:function(t){return f.a(this,t)}},{key:"cross",value:function(t){return f.c(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?y:n;return f.i(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?y:n;return f.j(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?y:n;return f.k(this,this,r,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return f.m(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return Object(l.c)(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return f.l(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){return Object(l.b)(this,this,t),this.check()}},{key:"transformByQuaternion",value:function(t){return f.n(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=Object(h.a)(t)}}]),e}(u.a)},function(t,e,n){"use strict";e.a={EPSILON1:.1,EPSILON2:.01,EPSILON3:.001,EPSILON4:1e-4,EPSILON5:1e-5,EPSILON6:1e-6,EPSILON7:1e-7,EPSILON8:1e-8,EPSILON9:1e-9,EPSILON10:1e-10,EPSILON11:1e-11,EPSILON12:1e-12,EPSILON13:1e-13,EPSILON14:1e-14,EPSILON15:1e-15,EPSILON16:1e-16,EPSILON17:1e-17,EPSILON18:1e-18,EPSILON19:1e-19,EPSILON20:1e-20,PI_OVER_TWO:Math.PI/2,PI_OVER_FOUR:Math.PI/4,PI_OVER_SIX:Math.PI/6,TWO_PI:2*Math.PI}},function(t,e,n){"use strict";var r=n(20),i=n(7),s=n(10),o=n(8),a=n(5),u=n(9),c=n(6),h=n(23),f=n(2),l=function(t){function e(){return Object(i.a)(this,e),Object(s.a)(this,Object(o.a)(e).apply(this,arguments))}return Object(u.a)(e,t),Object(a.a)(e,[{key:"toString",value:function(){var t="[";if(f.b.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=Object(c.a)(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),e}(h.a),y=n(14),d=n(4),g=n(12),v=n(3),b=n(11);n.d(e,"a",(function(){return T}));var m=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),p=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),E=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),O={},T=function(t){function e(t){var n;return Object(i.a)(this,e),n=Object(s.a)(this,Object(o.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(u.a)(e,t),Object(a.a)(e,[{key:"INDICES",get:function(){return E}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return O.IDENTITY=O.IDENTITY||Object.freeze(new e(m)),O.IDENTITY}},{key:"ZERO",get:function(){return O.ZERO=O.ZERO||Object.freeze(new e(p)),O.ZERO}}]),Object(a.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,s,o,a,u,c,h,f,l,y,d,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=h,this[11]=f,this[12]=l,this[13]=y,this[14]=d,this[15]=g,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,s,o,a,u,c,h,f,l,y,d,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=l,this[4]=e,this[5]=s,this[6]=c,this[7]=y,this[8]=n,this[9]=o,this[10]=h,this[11]=d,this[12]=r,this[13]=a,this[14]=f,this[15]=g,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(m)}},{key:"fromQuaternion",value:function(t){return d.b(this,t),this.check()}},{key:"frustum",value:function(t){var n=t.left,r=t.right,i=t.bottom,s=t.top,o=t.near,a=t.far;return a===1/0?e._computeInfinitePerspectiveOffCenter(this,n,r,i,s,o):d.c(this,n,r,i,s,o,a),this.check()}},{key:"lookAt",value:function(t,e,n){if(1===arguments.length){var r=t;t=r.eye,e=r.center,n=r.up}return e=e||[0,0,0],n=n||[0,1,0],d.e(this,t,e,n),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,s=t.near,o=void 0===s?.1:s,a=t.far,u=void 0===a?500:a;return d.g(this,e,n,r,i,o,u),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,s=void 0===i?1:i,o=t.focalDistance,a=void 0===o?1:o,u=t.near,c=void 0===u?.1:u,h=t.far,f=void 0===h?500:h;if(r>2*Math.PI)throw Error("radians");var l=r/2,y=a*Math.tan(l),d=y*s;return(new e).ortho({left:-d,right:d,bottom:-y,top:y,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,s=void 0===i?1:i,o=t.near,a=void 0===o?.1:o,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return d.h(this,e,s,a,c),this.check()}},{key:"determinant",value:function(){return d.a(this)}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*s,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*s,t}},{key:"transpose",value:function(){return d.o(this,this),this.check()}},{key:"invert",value:function(){return d.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return d.f(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return d.f(this,this,t),this.check()}},{key:"rotateX",value:function(t){return d.j(this,this,t),this.check()}},{key:"rotateY",value:function(t){return d.k(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return d.l(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(r.a)(t,3),n=e[0],i=e[1],s=e[2];return this.rotateX(n).rotateY(i).rotateZ(s)}},{key:"rotateAxis",value:function(t,e){return d.i(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?d.m(this,this,t):d.m(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return d.n(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(e=b.n(e||[-0,-0,-0,-0],t,this),Object(c.b)(e,4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=g.d(e||[-0,-0],t,this);break;case 3:e=v.m(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=Object(y.a)(e||[-0,-0],t,this);break;case 3:e=Object(y.c)(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return Object(c.b)(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"transformPoint",value:function(t,e){return Object(c.c)("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return Object(c.c)("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return Object(c.c)("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,n,r,i,s){var o=2*s/(n-e),a=2*s/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}}]),e}(l)},function(t,e,n){(function(e){const r=n(51),i="undefined"==typeof window?e:window;i.loaders=i.loaders||{},t.exports=Object.assign(i.loaders,r)}).call(this,n(27))},,,,,,,,,,,,,,function(t,e){var n,r,i=t.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(t){n=s}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(t){r=o}}();var u,c=[],h=!1,f=-1;function l(){h&&u&&(h=!1,u.length?c=u.concat(c):f=-1,c.length&&y())}function y(){if(!h){var t=a(l);h=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||h||a(y)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(t){return[]},i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(t,e,n){"use strict";n.r(e);var r={};n.r(r),n.d(r,"dirname",(function(){return u}));var i={};n.r(i),n.d(i,"decode",(function(){return ye})),n.d(i,"encode",(function(){return de}));var s={};n.r(s),n.d(s,"decode",(function(){return be})),n.d(s,"encode",(function(){return me}));var o={};n.r(o),n.d(o,"decode",(function(){return pe})),n.d(o,"encode",(function(){return Ee}));var a={};function u(t){const e=t&&t.lastIndexOf("/");return e>=0?t.substr(0,e):""}n.r(a),n.d(a,"decode",(function(){return Oe})),n.d(a,"encode",(function(){return Te}));const c={ADD:1,REPLACE:2},h={EMPTY:"empty",SCENEGRAPH:"scenegraph",POINTCLOUD:"pointcloud",MESH:"mesh"},f={I3S:"I3S",TILES3D:"TILES3D"},l={GEOMETRIC_ERROR:"geometricError",MAX_SCREEN_THRESHOLD:"maxScreenThreshold"},y={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect"},d=(Object.keys(y),{BATCHED_MODEL:[98,51,100,109],INSTANCED_MODEL:[105,51,100,109],POINT_CLOUD:[112,110,116,115],COMPOSITE:[99,109,112,116]});function g(t,e){if(!t)throw new Error(e||"loader assertion failed.")}function v(t,e,n){g(t instanceof ArrayBuffer);const r=new TextDecoder("utf8"),i=new Uint8Array(t,e,n);return r.decode(i)}var b=n(7),m=n(5),p=n(10),E=n(8),O=n(9),T=n(25);n(13),n(19),n(24);function w(t,e){if(!t)throw new Error("math.gl assertion ".concat(e))}Math.PI,Math.PI;var k={};function A(t){var e=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).precision,n=void 0===e?k.precision||4:e;return t=function(t){return Math.round(t/k.EPSILON)*k.EPSILON}(t),"".concat(parseFloat(t.toPrecision(n)))}function S(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&void 0!==t.length}function N(t,e,n){var r=k.EPSILON;n&&(k.EPSILON=n);try{if(t===e)return!0;if(S(t)&&S(e)){if(t.length!==e.length)return!1;for(var i=0;i<t.length;++i)if(!N(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):!(!Number.isFinite(t)||!Number.isFinite(e))&&Math.abs(t-e)<=k.EPSILON*Math.max(1,Math.abs(t),Math.abs(e))}finally{k.EPSILON=r}}k.EPSILON=1e-12,k.debug=!1,k.precision=4,k.printTypes=!1,k.printDegrees=!1,k.printRowMajor=!0;var I=function(t){function e(){return Object(b.a)(this,e),Object(p.a)(this,Object(E.a)(e).apply(this,arguments))}return Object(O.a)(e,t),Object(m.a)(e,[{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"from",value:function(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}},{key:"fromArray",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)this[n]=t[n+e];return this.check()}},{key:"to",value:function(t){return t===this?this:S(t)?this.toArray(t):this.toObject(t)}},{key:"toTarget",value:function(t){return t?this.to(t):this}},{key:"toArray",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<this.ELEMENTS;++n)t[e+n]=this[n];return t}},{key:"toFloat32Array",value:function(){return new Float32Array(this)}},{key:"toString",value:function(){return this.formatString(k)}},{key:"formatString",value:function(t){for(var e="",n=0;n<this.ELEMENTS;++n)e+=(n>0?", ":"")+A(this[n],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(e,"]")}},{key:"equals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(!N(this[e],t[e]))return!1;return!0}},{key:"exactEquals",value:function(t){if(!t||this.length!==t.length)return!1;for(var e=0;e<this.ELEMENTS;++e)if(this[e]!==t[e])return!1;return!0}},{key:"negate",value:function(){for(var t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}},{key:"lerp",value:function(t,e,n){void 0===n&&(n=e,e=t,t=this);for(var r=0;r<this.ELEMENTS;++r){var i=t[r];this[r]=i+n*(e[r]-i)}return this.check()}},{key:"min",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.min(t[e],this[e]);return this.check()}},{key:"max",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=Math.max(t[e],this[e]);return this.check()}},{key:"clamp",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t[n]),e[n]);return this.check()}},{key:"add",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]+=s[o];return this.check()}},{key:"subtract",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]-=s[o];return this.check()}},{key:"scale",value:function(t){if(Array.isArray(t))return this.multiply(t);for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"sub",value:function(t){return this.subtract(t)}},{key:"setScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]=t;return this.check()}},{key:"addScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]+=t;return this.check()}},{key:"subScalar",value:function(t){return this.addScalar(-t)}},{key:"multiplyScalar",value:function(t){for(var e=0;e<this.ELEMENTS;++e)this[e]*=t;return this.check()}},{key:"divideScalar",value:function(t){return this.scale(1/t)}},{key:"clampScalar",value:function(t,e){for(var n=0;n<this.ELEMENTS;++n)this[n]=Math.min(Math.max(this[n],t),e);return this.check()}},{key:"multiplyByScalar",value:function(t){return this.scale(t)}},{key:"check",value:function(){if(k.debug&&!this.validate(this))throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}},{key:"validate",value:function(){for(var t=this.length===this.ELEMENTS,e=0;e<this.ELEMENTS;++e)t=t&&Number.isFinite(this[e]);return t}},{key:"elements",get:function(){return this}}]),e}(Object(T.a)(Array));function L(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function M(t,e,n){if(k.debug&&!function(t,e){if(t.length!==e)return!1;for(var n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}(t,e))throw new Error("math.gl: ".concat(""|n," some fields set to invalid numbers'"));return t}var j={};function _(t,e){j[t]||(j[t]=!0,console.warn("".concat(t," has been removed in version ").concat(e,", see upgrade guide for more information")))}var R=function(t){function e(){return Object(b.a)(this,e),Object(p.a)(this,Object(E.a)(e).apply(this,arguments))}return Object(O.a)(e,t),Object(m.a)(e,[{key:"len",value:function(){return Math.sqrt(this.lengthSquared())}},{key:"magnitude",value:function(){return this.len()}},{key:"lengthSquared",value:function(){for(var t=0,e=0;e<this.ELEMENTS;++e)t+=this[e]*this[e];return t}},{key:"magnitudeSquared",value:function(){return this.lengthSquared()}},{key:"distance",value:function(t){return Math.sqrt(this.distanceSquared(t))}},{key:"distanceSquared",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n){var r=this[n]-t[n];e+=r*r}return L(e)}},{key:"dot",value:function(t){for(var e=0,n=0;n<this.ELEMENTS;++n)e+=this[n]*t[n];return L(e)}},{key:"normalize",value:function(){var t=this.magnitude();if(0!==t)for(var e=0;e<this.ELEMENTS;++e)this[e]/=t;return this.check()}},{key:"multiply",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]*=s[o];return this.check()}},{key:"divide",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];for(var r=0,i=e;r<i.length;r++)for(var s=i[r],o=0;o<this.ELEMENTS;++o)this[o]/=s[o];return this.check()}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"distanceTo",value:function(t){return this.distance(t)}},{key:"distanceToSquared",value:function(t){return this.distanceSquared(t)}},{key:"getComponent",value:function(t){return w(t>=0&&t<this.ELEMENTS,"index is out of range"),L(this[t])}},{key:"setComponent",value:function(t,e){return w(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=e,this.check()}},{key:"addVectors",value:function(t,e){return this.copy(t).add(e)}},{key:"subVectors",value:function(t,e){return this.copy(t).subtract(e)}},{key:"multiplyVectors",value:function(t,e){return this.copy(t).multiply(e)}},{key:"addScaledVector",value:function(t,e){return this.add(new this.constructor(t).multiplyScalar(e))}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=L(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=L(t)}}]),e}(I),x=n(3);function P(t,e,n){var r=e[0],i=e[1],s=e[2],o=n[3]*r+n[7]*i+n[11]*s||1;return t[0]=(n[0]*r+n[4]*i+n[8]*s)/o,t[1]=(n[1]*r+n[5]*i+n[9]*s)/o,t[2]=(n[2]*r+n[6]*i+n[10]*s)/o,t}var C=[0,0,0],B=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(b.a)(this,e),t=Object(p.a)(this,Object(E.a)(e).call(this,-0,-0,-0)),1===arguments.length&&S(n)?t.copy(n):(k.debug&&(L(n),L(r),L(i)),t[0]=n,t[1]=r,t[2]=i),t}return Object(O.a)(e,t),Object(m.a)(e,[{key:"set",value:function(t,e,n){return this[0]=t,this[1]=e,this[2]=n,this.check()}},{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}},{key:"fromObject",value:function(t){return k.debug&&(L(t.x),L(t.y),L(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}},{key:"toObject",value:function(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}},{key:"angle",value:function(t){return x.a(this,t)}},{key:"cross",value:function(t){return x.c(this,this,t),this.check()}},{key:"rotateX",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?C:n;return x.i(this,this,r,e),this.check()}},{key:"rotateY",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?C:n;return x.j(this,this,r,e),this.check()}},{key:"rotateZ",value:function(t){var e=t.radians,n=t.origin,r=void 0===n?C:n;return x.k(this,this,r,e),this.check()}},{key:"transform",value:function(t){return this.transformAsPoint(t)}},{key:"transformAsPoint",value:function(t){return x.m(this,this,t),this.check()}},{key:"transformAsVector",value:function(t){return P(this,this,t),this.check()}},{key:"transformByMatrix3",value:function(t){return x.l(this,this,t),this.check()}},{key:"transformByMatrix2",value:function(t){var e,n,r,i,s;return e=this,r=t,i=(n=this)[0],s=n[1],e[0]=r[0]*i+r[2]*s,e[1]=r[1]*i+r[3]*s,e[2]=n[2],this.check()}},{key:"transformByQuaternion",value:function(t){return x.n(this,this,t),this.check()}},{key:"ELEMENTS",get:function(){return 3}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=L(t)}}]),e}(R);const U={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},D={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,...U},V={[U.DOUBLE]:Float64Array,[U.FLOAT]:Float32Array,[U.UNSIGNED_SHORT]:Uint16Array,[U.UNSIGNED_INT]:Uint32Array,[U.UNSIGNED_BYTE]:Uint8Array,[U.BYTE]:Int8Array,[U.SHORT]:Int16Array,[U.INT]:Int32Array},F={DOUBLE:U.DOUBLE,FLOAT:U.FLOAT,UNSIGNED_SHORT:U.UNSIGNED_SHORT,UNSIGNED_INT:U.UNSIGNED_INT,UNSIGNED_BYTE:U.UNSIGNED_BYTE,BYTE:U.BYTE,SHORT:U.SHORT,INT:U.INT},z="Failed to convert GL type";class q{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const e in V){if(V[e]===t)return e}throw new Error(z)}static fromName(t){const e=F[t];if(!e)throw new Error(z);return e}static getArrayType(t,e=!1){switch(t){case U.UNSIGNED_SHORT_5_6_5:case U.UNSIGNED_SHORT_4_4_4_4:case U.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const e=V[t];if(!e)throw new Error(z);return e}}static getByteSize(t){return q.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return Boolean(q.getArrayType(t))}static createTypedArray(t,e,n=0,r){return void 0===r&&(r=(e.byteLength-n)/q.getByteSize(t)),new(q.getArrayType(t))(e,n,r)}}class G{constructor(t,e){this.json=t,this.buffer=e,this.featuresLength=0,this._cachedTypedArrays={}}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return Boolean(this.json[t])}getGlobalProperty(t,e=D.UNSIGNED_INT,n=1){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?this._getTypedArrayFromBinary(t,e,n,1,r.byteOffset):r}getPropertyArray(t,e,n){const r=this.json[t];return r&&Number.isFinite(r.byteOffset)?("componentType"in r&&(e=q.fromName(r.componentType)),this._getTypedArrayFromBinary(t,e,n,this.featuresLength,r.byteOffset)):this._getTypedArrayFromArray(t,e,r)}getProperty(t,e,n,r,i){const s=this.json[t];if(!s)return s;const o=this.getPropertyArray(t,e,n);if(1===n)return o[r];for(let t=0;t<n;++t)i[t]=o[n*r+t];return i}_getTypedArrayFromBinary(t,e,n,r,i){const s=this._cachedTypedArrays;let o=s[t];return o||(o=q.createTypedArray(e,this.buffer.buffer,this.buffer.byteOffset+i,r*n),s[t]=o),o}_getTypedArrayFromArray(t,e,n){const r=this._cachedTypedArrays;let i=r[t];return i||(i=q.createTypedArray(e,n),r[t]=i),i}}const H={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},W={SCALAR:(t,e)=>t[e],VEC2:(t,e)=>[t[2*e+0],t[2*e+1]],VEC3:(t,e)=>[t[3*e+0],t[3*e+1],t[3*e+2]],VEC4:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT2:(t,e)=>[t[4*e+0],t[4*e+1],t[4*e+2],t[4*e+3]],MAT3:(t,e)=>[t[9*e+0],t[9*e+1],t[9*e+2],t[9*e+3],t[9*e+4],t[9*e+5],t[9*e+6],t[9*e+7],t[9*e+8]],MAT4:(t,e)=>[t[16*e+0],t[16*e+1],t[16*e+2],t[16*e+3],t[16*e+4],t[16*e+5],t[16*e+6],t[16*e+7],t[16*e+8],t[16*e+9],t[16*e+10],t[16*e+11],t[16*e+12],t[16*e+13],t[16*e+14],t[16*e+15]]},$={SCALAR:(t,e,n)=>{e[n]=t},VEC2:(t,e,n)=>{e[2*n+0]=t[0],e[2*n+1]=t[1]},VEC3:(t,e,n)=>{e[3*n+0]=t[0],e[3*n+1]=t[1],e[3*n+2]=t[2]},VEC4:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT2:(t,e,n)=>{e[4*n+0]=t[0],e[4*n+1]=t[1],e[4*n+2]=t[2],e[4*n+3]=t[3]},MAT3:(t,e,n)=>{e[9*n+0]=t[0],e[9*n+1]=t[1],e[9*n+2]=t[2],e[9*n+3]=t[3],e[9*n+4]=t[4],e[9*n+5]=t[5],e[9*n+6]=t[6],e[9*n+7]=t[7],e[9*n+8]=t[8],e[9*n+9]=t[9]},MAT4:(t,e,n)=>{e[16*n+0]=t[0],e[16*n+1]=t[1],e[16*n+2]=t[2],e[16*n+3]=t[3],e[16*n+4]=t[4],e[16*n+5]=t[5],e[16*n+6]=t[6],e[16*n+7]=t[7],e[16*n+8]=t[8],e[16*n+9]=t[9],e[16*n+10]=t[10],e[16*n+11]=t[11],e[16*n+12]=t[12],e[16*n+13]=t[13],e[16*n+14]=t[14],e[16*n+15]=t[15]}};const Y=t=>void 0!==t;function Z(t,e,n){if(!e)return null;let r=t.getExtension("3DTILES_batch_table_hierarchy");const i=e.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),e.extensions=e.extensions||{},e.extensions["3DTILES_batch_table_hierarchy"]=i,r=i),r?function(t,e){let n,r,i;const s=t.instancesLength,o=t.classes,a=t.classIds,u=t.parentCounts,c=t.parentIds,h=s;Y(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(e.buffer,e.byteOffset+a.byteOffset,s));let f;if(Y(u))for(Y(u.byteOffset)&&(u.componentType=defaultValue(u.componentType,GL.UNSIGNED_SHORT),u.type=AttributeType.SCALAR,i=getBinaryAccessor(u),u=i.createArrayBufferView(e.buffer,e.byteOffset+u.byteOffset,s)),f=new Uint16Array(s),h=0,n=0;n<s;++n)f[n]=h,h+=u[n];Y(c)&&Y(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(e.buffer,e.byteOffset+c.byteOffset,h));const l=o.length;for(n=0;n<l;++n){const t=o[n].length,r=o[n].instances,i=getBinaryProperties(t,r,e);o[n].instances=combine(i,r)}const y=new Array(l).fill(0),d=new Uint16Array(s);for(n=0;n<s;++n)r=a[n],d[n]=y[r],++y[r];const g={classes:o,classIds:a,classIndexes:d,parentCounts:u,parentIndexes:f,parentIds:c};return function(t){const e=t.classIds.length;for(let n=0;n<e;++n)Q(t,n,stack)}(g),g}(r,n):null}function K(t,e,n){if(!t)return;const r=t.parentCounts;return t.parentIds?n(t,e):r>0?function(t,e,n){const r=t.classIds,i=t.parentCounts,s=t.parentIds,o=t.parentIndexes,a=r.length,u=scratchVisited;u.length=Math.max(u.length,a);const c=++marker,h=scratchStack;h.length=0,h.push(e);for(;h.length>0;){if(e=h.pop(),u[e]===c)continue;u[e]=c;const r=n(t,e);if(Y(r))return r;const a=i[e],f=o[e];for(let t=0;t<a;++t){const n=s[f+t];n!==e&&h.push(n)}}return null}(t,e,n):function(t,e,n){let r=!0;for(;r;){const i=n(t,e);if(Y(i))return i;const s=t.parentIds[e];r=s!==e,e=s}throw new Error("traverseHierarchySingleParent")}(t,e,n)}function Q(t,e,n){const r=t.parentCounts,i=t.parentIds,s=t.parentIndexes,o=t.classIds.length;if(!Y(i))return;assert(e<o,`Parent index ${e} exceeds the total number of instances: ${o}`),assert(-1===n.indexOf(e),"Circular dependency detected in the batch table hierarchy."),n.push(e);const a=Y(r)?r[e]:1,u=Y(r)?s[e]:e;for(let r=0;r<a;++r){const s=i[u+r];s!==e&&Q(t,s,n)}n.pop(e)}function X(t){return null!=t}const J=t=>t,tt={HIERARCHY:!0,extensions:!0,extras:!0};class et{constructor(t,e,n,r={}){g(n>=0),this.json=t||{},this.binary=e,this.featureCount=n,this._extensions=this.json&&this.json.extensions||{},this._properties={};for(const t in this.json)tt[t]||(this._properties[t]=this.json[t]);this._binaryProperties=this._initializeBinaryProperties(),r["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Z(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,e){if(this._checkBatchId(t),g("string"==typeof e,e),this._hierarchy){return X(K(this._hierarchy,t,(t,n)=>{const r=t.classIds[n];return t.classes[r].name===e}))}return!1}isExactClass(t,e){return g("string"==typeof e,e),this.getExactClassName(t)===e}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const e=this._hierarchy.classIds[t];return this._hierarchy.classes[e].name}}hasProperty(t,e){return this._checkBatchId(t),g("string"==typeof e,e),X(this._properties[e])||this._hasPropertyInHierarchy(t,e)}getPropertyNames(t,e){this._checkBatchId(t),(e=X(e)?e:[]).length=0;const n=Object.keys(this._properties);return e.push(...n),this._hierarchy&&this._getPropertyNamesInHierarchy(t,e),e}getProperty(t,e){if(this._checkBatchId(t),g("string"==typeof e,e),this._binaryProperties){const n=this._binaryProperties[e];if(X(n))return this._getBinaryProperty(n,t)}const n=this._properties[e];if(X(n))return J(n[t],!0);if(this._hierarchy){const n=this._getHierarchyProperty(t,e);if(X(n))return n}}setProperty(t,e,n){const r=this.featureCount;if(this._checkBatchId(t,r),g("string"==typeof e,e),this._binaryProperties){const r=this._binaryProperties[e];if(r)return void this._setBinaryProperty(r,t,n)}if(this._hierarchy&&this._setHierarchyProperty(this,t,e,n))return;let i=this._properties[e];X(i)||(this._properties[e]=new Array(r),i=this._properties[e]),i[t]=J(n,!0)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,e){return t.unpack(t.typedArray,e)}_setBinaryProperty(t,e,n){t.pack(n,t.typedArray,e)}_initializeBinaryProperties(){let t=null;for(const e in this._properties){const n=this._properties[e],r=this._initializeBinaryProperty(e,n);r&&(t=t||{},t[e]=r)}return t}_initializeBinaryProperty(t,e){if("byteOffset"in e){const n=e;g(this.binary,`Property ${t} requires a batch table binary.`),g(n.type,`Property ${t} requires a type.`);const r=function(t,e,n,r){const{componentType:i}=t;g(t.componentType);const s="string"==typeof i?q.fromName(i):i,o=H[t.type],a=W[t.type],u=$[t.type];return n+=t.byteOffset,{values:q.createTypedArray(s,e,n,o*r),type:s,size:o,unpacker:a,packer:u}}(n,this.binary.buffer,0|this.binary.byteOffset,this.featureCount);return{typedArray:r.values,componentCount:r.size,unpack:r.unpacker,pack:r.packer}}return null}_hasPropertyInHierarchy(t,e){if(!this._hierarchy)return!1;const n=K(this._hierarchy,t,(t,n)=>{const r=t.classIds[n];return X(t.classes[r].instances[e])});return X(n)}_getPropertyNamesInHierarchy(t,e){K(this._hierarchy,t,(t,n)=>{const r=t.classIds[n],i=t.classes[r].instances;for(const t in i)i.hasOwnProperty(t)&&-1===e.indexOf(t)&&e.push(t)})}_getHierarchyProperty(t,e){return K(this._hierarchy,t,(t,n)=>{const r=t.classIds[n],i=t.classes[r],s=t.classIndexes[n],o=i.instances[e];return X(o)?X(o.typedArray)?this._getBinaryProperty(o,s):J(o[s],!0):null})}_setHierarchyProperty(t,e,n,r){const i=K(this._hierarchy,e,(t,i)=>{const s=t.classIds[i],o=t.classes[s],a=t.classIndexes[i],u=o.instances[n];return!!X(u)&&(g(i===e,`Inherited property "${n}" is read-only.`),X(u.typedArray)?this._setBinaryProperty(u,a,r):u[a]=J(r,!0),!0)});return X(i)}}const nt=4;function rt(t,e,n=0){const r=new DataView(e);if(t.magic=r.getUint32(n,!0),n+=nt,t.version=r.getUint32(n,!0),n+=nt,t.byteLength=r.getUint32(n,!0),n+=nt,1!==t.version)throw new Error(`3D Tile Version ${t.version} not supported`);return n}const it=4;function st(t,e,n){const r=new DataView(e);return t.header=t.header||{},t.header.featureTableJsonByteLength=r.getUint32(n,!0),n+=it,t.header.featureTableBinaryByteLength=r.getUint32(n,!0),n+=it,t.header.batchTableJsonByteLength=r.getUint32(n,!0),n+=it,t.header.batchTableBinaryByteLength=r.getUint32(n,!0),n+=it}function ot(t,e,n,r){return n=function(t,e,n,r){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:s}=t.header;if(t.featureTableJson={BATCH_LENGTH:0},i>0){const r=v(e,n,i);t.featureTableJson=JSON.parse(r)}return n+=i,t.featureTableBinary=new Uint8Array(e,n,s),n+=s}(t,e,n),n=function(t,e,n,r){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:s}=t.header;if(i>0){const r=v(e,n,i);t.batchTableJson=JSON.parse(r),n+=i,s>0&&(t.batchTableBinary=new Uint8Array(e,n,s),t.batchTableBinary=new Uint8Array(t.batchTableBinary),n+=s)}return n}(t,e,n)}function at(t,e=[0,0,0]){const n=t>>11&31,r=t>>5&63,i=31&t;return e[0]=n<<3,e[1]=r<<2,e[2]=i<<3,e}function ut(t,e,n){if(!(e||t&&t.batchIds&&n))return null;const{batchIds:r,isRGB565:i,pointCount:s}=t;if(r&&n){const t=new Uint8ClampedArray(3*s);for(let e=0;e<s;e++){const i=r[e],s=n.getProperty(i,"dimensions").map(t=>255*t);t[3*e]=s[0],t[3*e+1]=s[1],t[3*e+2]=s[2]}return{type:D.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}if(i){const t=new Uint8ClampedArray(3*s);for(let n=0;n<s;n++){const r=at(e[n]);t[3*n]=r[0],t[3*n+1]=r[1],t[3*n+2]=r[2]}return{type:D.UNSIGNED_BYTE,value:t,size:3,normalized:!0}}return e&&e.length===3*s?{type:D.UNSIGNED_BYTE,value:e,size:3,normalized:!0}:{type:D.UNSIGNED_BYTE,value:e,size:4,normalized:!0}}var ct=n(1);function ht(t,e){if(!t)throw new Error(`math.gl assertion failed. ${e}`)}new ct.b,new ct.c,new ct.b,new ct.b,new Uint8Array(1);function ft(t,e=255){return Object(ct.f)(t,0,e)/e*2-1}function lt(t){return t<0?-1:1}function yt(t,e,n,r){if(ht(r),t<0||t>n||e<0||e>n)throw new Error(`x and y must be unsigned normalized integers between 0 and ${n}`);if(r.x=ft(t,n),r.y=ft(e,n),r.z=1-(Math.abs(r.x)+Math.abs(r.y)),r.z<0){const t=r.x;r.x=(1-Math.abs(r.y))*lt(t),r.y=(1-Math.abs(t))*lt(r.y)}return r.normalize()}function dt(t,e,n){return yt(t,e,255,n)}const gt=new B;function vt(t,e,n){return t.isQuantized?n.decodeQuantizedPositions?(t.isQuantized=!1,function(t,e){const n=new B,r=new Float32Array(3*t.pointCount);for(let i=0;i<t.pointCount;i++)n.set(e[3*i],e[3*i+1],e[3*i+2]).scale(1/t.quantizedRange).multiply(t.quantizedVolumeScale).add(t.quantizedVolumeOffset).toArray(r,3*i);return r}(t,e)):{type:D.UNSIGNED_SHORT,value:e,size:3,normalized:!0}:e}async function bt(t,e,n,r,i){n=ot(t,e,n=st(t,e,n=rt(t,e,n))),function(t){t.attributes={positions:null,colors:null,normals:null,batchIds:null},t.isQuantized=!1,t.isTranslucent=!1,t.isRGB565=!1,t.isOctEncoded16P=!1}(t);const{featureTable:s,batchTable:o}=function(t){const e=new G(t.featureTableJson,t.featureTableBinary),n=e.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(n))throw new Error("POINTS_LENGTH must be defined");e.featuresLength=n,t.featuresLength=n,t.pointsLength=n,t.pointCount=n,t.rtcCenter=e.getGlobalProperty("RTC_CENTER",D.FLOAT,3);const r=function(t,e){let n=null;if(!t.batchIds&&e.hasProperty("BATCH_ID")&&(t.batchIds=e.getPropertyArray("BATCH_ID",D.UNSIGNED_SHORT,1),t.batchIds)){const r=e.getGlobalProperty("BATCH_LENGTH");if(!r)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:s}=t;n=new et(i,s,r)}return n}(t,e);return{featureTable:e,batchTable:r}}(t);return await async function(t,e,n,r,i){let s,o,a;const u=n&&n.getExtension("3DTILES_draco_point_compression");u&&(a=u.properties);const c=e.getExtension("3DTILES_draco_point_compression");if(c){o=c.properties;const e=c.byteOffset,n=c.byteLength;if(!o||!Number.isFinite(e)||!n)throw new Error("Draco properties, byteOffset, and byteLength must be defined");s=t.featureTableBinary.slice(e,e+n),t.hasPositions=Number.isFinite(o.POSITION),t.hasColors=Number.isFinite(o.RGB)||Number.isFinite(o.RGBA),t.hasNormals=Number.isFinite(o.NORMAL),t.hasBatchIds=Number.isFinite(o.BATCH_ID),t.isTranslucent=Number.isFinite(o.RGBA)}if(!s)return!0;const h={buffer:s,properties:{...o,...a},featureTableProperties:o,batchTableProperties:a,dequantizeInShader:!1};return await async function(t,e,n,r){const{parse:i}=r,s=await i(e.buffer,{}),o=s.attributes.POSITION&&s.attributes.POSITION.value,a=s.attributes.COLOR_0&&s.attributes.COLOR_0.value,u=s.attributes.NORMAL&&s.attributes.NORMAL.value,c=s.attributes.BATCH_ID&&s.attributes.BATCH_ID.value,h=o&&s.attributes.POSITION.value.quantization,f=u&&s.attributes.NORMAL.value.quantization;if(h){const e=s.POSITION.data.quantization,n=e.range;t.quantizedVolumeScale=new B(n,n,n),t.quantizedVolumeOffset=new B(e.minValues),t.quantizedRange=(1<<e.quantizationBits)-1,t.isQuantizedDraco=!0}f&&(t.octEncodedRange=(1<<s.NORMAL.data.quantization.quantizationBits)-1,t.isOctEncodedDraco=!0);t.attributes={positions:o,colors:ut(t,a),normals:u,batchIds:c}}(t,h,0,i)}(t,s,o,0,i),function(t,e,n){if(!t.attributes.positions)if(e.hasProperty("POSITION"))t.attributes.positions=e.getPropertyArray("POSITION",D.FLOAT,3);else if(e.hasProperty("POSITION_QUANTIZED")){const r=e.getPropertyArray("POSITION_QUANTIZED",D.UNSIGNED_SHORT,3);if(t.isQuantized=!0,t.quantizedRange=65535,t.quantizedVolumeScale=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",D.FLOAT,3),!t.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(t.quantizedVolumeOffset=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",D.FLOAT,3),!t.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");t.attributes.positions=vt(t,r,n)}if(!t.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}(t,s,r),function(t,e,n){if(!t.attributes.colors){let r=null;e.hasProperty("RGBA")?(r=e.getPropertyArray("RGBA",D.UNSIGNED_BYTE,4),t.isTranslucent=!0):e.hasProperty("RGB")?r=e.getPropertyArray("RGB",D.UNSIGNED_BYTE,3):e.hasProperty("RGB565")&&(r=e.getPropertyArray("RGB565",D.UNSIGNED_SHORT,1),t.isRGB565=!0),t.attributes.colors=ut(t,r,n)}e.hasProperty("CONSTANT_RGBA")&&(t.constantRGBA=e.getGlobalProperty("CONSTANT_RGBA",D.UNSIGNED_BYTE,4))}(t,s,o),function(t,e){if(!t.attributes.normals){let n=null;e.hasProperty("NORMAL")?n=e.getPropertyArray("NORMAL",D.FLOAT,3):e.hasProperty("NORMAL_OCT16P")&&(n=e.getPropertyArray("NORMAL_OCT16P",D.UNSIGNED_BYTE,2),t.isOctEncoded16P=!0),t.attributes.normals=function(t,e){if(!e)return null;if(t.isOctEncoded16P){const n=new Float32Array(3*t.pointsLength);for(let r=0;r<t.pointsLength;r++)dt(e[2*r],e[2*r+1],gt),gt.toArray(n,3*r);return{type:D.FLOAT,size:2,value:n}}return{type:D.FLOAT,size:2,value:e}}(t,n)}}(t,s),n}function mt(t,e){if(!t)throw new Error(e)}var pt=n(21);const{_parseImageNode:Et}=pt.a,Ot="undefined"!=typeof Image,Tt="undefined"!=typeof ImageBitmap,wt=Boolean(Et);function kt(t){switch(t){case"auto":return Tt||Ot||wt;case"imagebitmap":return Tt;case"html":case"image":return Ot;case"ndarray":case"data":return!!pt.b||wt;default:throw new Error(`@loaders.gl/images: image ${t} not supported in this environment`)}}function At(t){const e=St(t);if(!e)throw new Error("Not an image");return e}function St(t){return"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap?"imagebitmap":"undefined"!=typeof Image&&t instanceof Image?"image":t&&"object"==typeof t&&t.data&&t.width&&t.height?"data":null}const Nt=/^data:image\/svg\+xml/,It=/\.svg((\?|#).*)?$/;function Lt(t,e){return Mt(e)?(console.warn("SVG cannot be parsed to imagebitmap"),new Blob([new Uint8Array(t)],{type:"image/svg+xml"})):new Blob([new Uint8Array(t)])}function Mt(t){return t&&(Nt.test(t)||It.test(t))}async function jt(t,e,n){const r=function(t,e){if(Mt(e)){const e=(new TextDecoder).decode(t);return`data:image/svg+xml;base64,${btoa(e)}`}return Lt(t,e)}(t,n),i=self.URL||self.webkitURL,s="string"!=typeof r&&i.createObjectURL(r);try{return await async function(t,e){const n=new Image;if(n.src=t,e.image&&e.image.decode&&n.decode)return await n.decode(),n;return await new Promise((e,r)=>{try{n.onload=()=>e(n),n.onerror=e=>r(new Error(`Could not load image ${t}: ${e}`))}catch(t){r(t)}})}(s||r,e)}finally{s&&i.revokeObjectURL(s)}}let _t=!0;async function Rt(t,e,n){const r=Lt(t,n);let i=e&&e.imagebitmap;if(!function(t){for(const e in t||xt)return!0;return!1}(i)&&_t||(i=null),i)try{return await createImageBitmap(r,i)}catch(t){console.warn(t),_t=!1}return await createImageBitmap(r)}const xt={};const Pt=!1,Ct=!0,Bt=new Map([["image/png",{test:Ut,getSize:function(t){return{width:t.getUint32(16,Pt),height:t.getUint32(20,Pt)}}}],["image/jpeg",{test:Ft,getSize:function(t){if(t.byteLength<2||65496!==t.getUint16(0,Pt))return null;const{tableMarkers:e,sofMarkers:n}=function(){const t=new Set([65499,65476,65484,65501,65534]);for(let e=65504;e<65520;++e)t.add(e);const e=new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502]);return{tableMarkers:t,sofMarkers:e}}();let r=2;for(;r<t.byteLength;){const i=t.getUint16(r,Pt);if(n.has(i))return{height:t.getUint16(r+5,Pt),width:t.getUint16(r+7,Pt)};if(!e.has(i))return null;r+=2,r+=t.getUint16(r,Pt)}return null}}],["image/gif",{test:Dt,getSize:function(t){return{width:t.getUint16(6,Ct),height:t.getUint16(8,Ct)}}}],["image/bmp",{test:Vt,getSize:function(t){return{width:t.getUint32(18,Ct),height:t.getUint32(22,Ct)}}}]]);function Ut(t){return t.byteLength>=24&&2303741511===t.getUint32(0,Pt)}function Dt(t){return t.byteLength>=10&&1195984440===t.getUint32(0,Pt)}function Vt(t){return t.byteLength>=14&&16973===t.getUint16(0,Pt)&&t.getUint32(2,Ct)===t.byteLength}function Ft(t){return t.byteLength>=3&&65496===t.getUint16(0,Pt)&&255===t.getUint8(2,Pt)}Array.from(Bt.keys()).join(", ");function zt(t){const e=qt(t);for(const[t,{test:n}]of Bt.entries())if(n(e))return t;return null}function qt(t){if((t=t.buffer||t)instanceof ArrayBuffer)return new DataView(t);if(ArrayBuffer.isView(t))return new DataView(t.buffer);throw new Error("toDataView")}var Gt={name:"Images",version:"2.1.1",mimeTypes:["image/png","image/jpeg","image/gif","image/webp","image/bmp","image/vndmicrosofticon","image/svg+xml"],extensions:["png","jpg","jpeg","gif","webp","bmp","ico","svg"],parse:async function(t,e,n){const r=((e=e||{}).image||{}).type||"auto",{url:i}=n||{};let s;switch(function(t){switch(t){case"auto":case"data":return function(){if(kt("image"))return"image";if(kt("imagebitmap"))return"imagebitmap";if(kt("data"))return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}();default:return kt(t),t}}(r)){case"imagebitmap":s=await Rt(t,e,i);break;case"image":s=await jt(t,e,i);break;case"data":s=await function(t,e){const n=zt(t),{_parseImageNode:r}=pt.a;return mt(r),r(t,n,e)}(t,e);break;default:mt(!1)}return"data"===r&&(s=function(t){switch(At(t)){case"data":return t;case"image":case"imagebitmap":const e=document.createElement("canvas"),n=e.getContext("2d");return e.width=t.width,e.height=t.height,n.drawImage(t,0,0),n.getImageData(0,0,t.width,t.height);default:return mt(!1)}}(s)),s},test:t=>{const e=new DataView(t);return Ft(e)||Vt(e)||Dt(e)||Ut(e)},options:{image:{format:"auto",decode:!0}}};function Ht(t,e,n){if(t.byteLength<=e+n)return"";const r=new DataView(t);let i="";for(let t=0;t<n;t++)i+=String.fromCharCode(r.getUint8(e+t));return i}function Wt(t){try{return JSON.parse(t)}catch(e){throw new Error(`Failed to parse JSON from data starting with "${function(t,e=5){if("string"==typeof t)return t.slice(0,e);if(ArrayBuffer.isView(t))return Ht(t.buffer,t.byteOffset,e);if(t instanceof ArrayBuffer){return Ht(t,0,e)}return""}(t)}"`)}}function $t(t){return t+3&-4}function Yt(t,e,n){const r=n?new Uint8Array(t).subarray(e,e+n):new Uint8Array(t).subarray(e);return new Uint8Array(r).buffer}function Zt(t,e,n){let r;if(t instanceof ArrayBuffer)r=new Uint8Array(t);else{const e=t.byteOffset,n=t.byteLength;r=new Uint8Array(t.buffer,e,n)}return e.set(r,n),n+$t(r.byteLength)}function Kt(t,e){if(!t)throw new Error(e||"assert failed: gltf")}function Qt(t,e){if(t.startsWith("data:")||t.startsWith("http:")||t.startsWith("https:"))return t;const n=e.baseUri||e.uri;if(!n)throw new Error(`'baseUri' must be provided to resolve relative url ${t}`);return n.substr(0,n.lastIndexOf("/")+1)+t}function Xt(t,e,n){const r=t.bufferViews[n];Kt(r);const i=e[r.buffer];Kt(i);const s=(r.byteOffset||0)+i.byteOffset;return new Uint8Array(i.arrayBuffer,s,r.byteLength)}const Jt=["SCALAR","VEC2","VEC3","VEC4"],te=new Map([[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126]]),ee={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ne={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},re={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function ie(t){return Jt[t-1]||Jt[0]}function se(t){const e=te.get(t.constructor);if(!e)throw new Error("Illegal typed array");return e}function oe(t,e){const n=re[t.componentType],r=ee[t.type],i=ne[t.componentType],s=t.count*r,o=t.count*r*i;return Kt(o>=0&&o<=e.byteLength),{ArrayType:n,length:s,byteLength:o}}class ae{constructor(t){if(t instanceof ae)return t;t||(t={json:{version:2,buffers:[]},buffers:[]}),this.gltf=t,Kt(this.gltf.json)}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}getExtension(t){const e=this.getUsedExtensions().find(e=>e===t),n=this.json.extensions||{};return e?n[t]||!0:null}getRequiredExtension(t){return this.getRequiredExtensions().find(e=>e===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getObjectExtension(t,e){return(t.extensions||{})[e]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getCamera(t){return null}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];if(!n)throw new Error(`glTF file error: Could not find ${t}[${e}]`);return n}getTypedArrayForBufferView(t){const e=(t=this.getBufferView(t)).buffer,n=this.gltf.buffers[e];Kt(n);const r=(t.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,r,t.byteLength)}getTypedArrayForAccessor(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,{ArrayType:r,length:i}=oe(t,e);return new r(n,e.byteOffset+t.byteOffset,i)}getTypedArrayForImageData(t){t=this.getAccessor(t);const e=this.getBufferView(t.bufferView),n=this.getBuffer(e.buffer).data,r=e.byteOffset||0;return new Uint8Array(n,r,e.byteLength)}addApplicationData(t,e){return this.json[t]=e,this}addExtraData(t,e){return this.json.extras=this.json.extras||{},this.json.extras[t]=e,this}addObjectExtension(t,e,n){return Kt(n),t.extensions=t.extensions||{},t.extensions[e]=n,this.registerUsedExtension(e),this}removeObjectExtension(t,e){return delete(t.extensions||{})[e],this}addExtension(t,e={}){return Kt(e),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=e,this.registerUsedExtension(t),e}addRequiredExtension(t,e={}){return Kt(e),this.addExtension(t,e),this.registerRequiredExtension(t),e}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(e=>e===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(e=>e===t)||this.json.extensionsRequired.push(t)}removeExtension(t){this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t),this.json.extensions&&delete this.json.extensions[t]}setObjectExtension(t,e,n){(t.extensions||{})[e]=n}addMesh(t,e,n=4){const r={primitives:[{attributes:this._addAttributes(t),indices:e,mode:n}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addPointCloud(t){const e={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(e),this.json.meshes.length-1}addImage(t,e){e=e||zt(t);const n={bufferView:this.addBufferView(t),mimeType:e};return this.json.images=this.json.images||[],this.json.images.push(n),this.json.images.length-1}addBufferView(t){const e=t.byteLength;Kt(Number.isFinite(e)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:0,byteOffset:this.byteLength,byteLength:e};return this.byteLength+=$t(e),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,e){const n={bufferView:t,type:ie(e.size),componentType:e.componentType,count:e.count};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(n),this.json.accessors.length-1}addBinaryBuffer(t,e={size:3}){const n=this.addBufferView(t),r={size:e.size,componentType:se(t),count:Math.round(t.length/e.size)};return this.addAccessor(n,Object.assign(r,e))}createBinaryChunk(){if(this.arrayBuffer)return;const t=this.byteLength,e=new ArrayBuffer(t),n=new Uint8Array(e);let r=0;for(let t=0;t<this.sourceBuffers.length;t++){r=Zt(this.sourceBuffers[t],n,r)}this.json.buffers[0].byteLength=t,this.arrayBuffer=e,this.sourceBuffers=[]}_removeStringFromArray(t,e){let n=!0;for(;n;){const r=t.indexOf(e);r>-1?t.splice(r,1):n=!1}}}const ue="KHR_draco_mesh_compression",ce="KHR_lights_punctual",he="KHR_materials_unlit",fe="KHR_techniques_webgl";function le(t,e){const{buffer:n,size:r,count:i}=function(t,e){let n=t,r=1,i=0;t&&t.value&&(n=t.value,r=t.size||1);n&&(ArrayBuffer.isView(n)||(n=function(t,e,n=!1){if(!t)return null;if(Array.isArray(t))return new e(t);if(n&&!(t instanceof e))return new e(t);return t}(n,Float32Array)),i=n.length/r);return{buffer:n,size:r,count:i}}(t);return{value:n,size:r,bufferView:null,byteOffset:0,count:i,type:ie(r),componentType:se(n)}}async function ye(t,e,n){if(!e.gltf.decompressMeshes)return;const r=new ae(t),i=[];for(const t of function*(t){for(const e of t.json.meshes||[])for(const t of e.primitives)yield t}(r))r.getObjectExtension(t,ue)&&i.push(ge(t,r,e,n));await Promise.all(i),r.removeExtension(ue)}function de(t,e={}){const n=new ae(t);for(const t of n.json.meshes||[])ve(t,e),n.addRequiredExtension(ue)}async function ge(t,e,n,r){const i=e.getObjectExtension(t,ue),s=e.getTypedArrayForBufferView(i.bufferView),o=Yt(s.buffer,s.byteOffset),{parse:a}=r,u=await a(o,[],n,r);t.attributes=function(t){const e={};for(const n in t){const r=t[n];if("indices"!==n){const t=le(r);e[n]=t}}return e}(u.attributes),u.indices&&(t.indices=le(u.indices)),function(t){if(!t.attributes&&Object.keys(t.attributes).length>0)throw new Error("Empty glTF primitive detected: Draco decompression failure?")}(t)}function ve(t,e,n=4,r,i){if(!r.DracoWriter||!r.DracoLoader)throw new Error("DracoWriter/DracoLoader not available");const s=r.DracoWriter.encodeSync({attributes:t}),{parseSync:o}=i,a=o({attributes:t}),u=r._addFauxAttributes(a.attributes),c=r.addBufferView(s);return{primitives:[{attributes:u,mode:n,extensions:{[ue]:{bufferView:c,attributes:u}}}]}}function be(t,e){const n=new ae(t),{json:r}=n,i=n.getExtension(ce);i&&(n.json.lights=i.lights,n.removeExtension(ce));for(const t of r.nodes||[]){const e=n.getObjectExtension(t,ce);e&&(t.light=e.light),n.removeObjectExtension(t,ce)}}function me(t,e){const n=new ae(t),{json:r}=n;if(r.lights){const t=n.addExtension(ce);Kt(!t.lights),t.lights=r.lights,delete r.lights}if(n.json.lights){for(const t of n.json.lights){const e=t.node;n.addObjectExtension(e,ce,t)}delete n.json.lights}}function pe(t,e){const n=new ae(t),{json:r}=n;n.removeExtension(he);for(const t of r.materials||[]){t.extensions&&t.extensions.KHR_materials_unlit&&(t.unlit=!0),n.removeObjectExtension(t,he)}}function Ee(t,e){const n=new ae(t),{json:r}=n;if(n.materials)for(const t of r.materials)t.unlit&&(delete t.unlit,n.addObjectExtension(t,he),n.addExtension(he))}function Oe(t,e){const n=new ae(t),{json:r}=n,i=n.getExtension(fe);if(i){const t=function({programs:t=[],shaders:e=[],techniques:n=[]},r){const i=new TextDecoder;return e.forEach(t=>{if(!Number.isFinite(t.bufferView))throw new Error("KHR_techniques_webgl: no shader code");t.code=i.decode(r.getTypedArrayForBufferView(t.bufferView))}),t.forEach(t=>{t.fragmentShader=e[t.fragmentShader],t.vertexShader=e[t.vertexShader]}),n.forEach(e=>{e.program=t[e.program]}),n}(i,n);for(const e of r.materials||[]){const r=n.getObjectExtension(e,fe);r&&(e.technique=Object.assign({},r,t[r.technique]),e.technique.values=we(e.technique,n)),n.removeObjectExtension(e,fe)}n.removeExtension(fe)}}function Te(t,e){}function we(t,e){const n=Object.assign({},t.values);return Object.keys(t.uniforms||{}).forEach(e=>{!t.uniforms[e].value||e in n||(n[e]=t.uniforms[e].value)}),Object.keys(n).forEach(t=>{"object"==typeof n[t]&&void 0!==n[t].index&&(n[t].texture=e.getTexture(n[t].index))}),n}const ke={KHR_draco_mesh_compression:i,KHR_lights_punctual:s,KHR_materials_unlit:o,KHR_techniques_webgl:a};const Ae=1735152710,Se=12,Ne=8,Ie=1313821514,Le=5130562,Me=0,je=1,_e=!0;function Re(t,e=0,n={}){const r=new DataView(t),{magic:i=Ae}=n,s=r.getUint32(e,!1);return s===i||s===Ae}function xe(t,e,n=0,r={}){const i=new DataView(e);t.type=function(t,e=0){return`${String.fromCharCode(t.getUint8(e+0))}${String.fromCharCode(t.getUint8(e+1))}${String.fromCharCode(t.getUint8(e+2))}${String.fromCharCode(t.getUint8(e+3))}`}(i,n+0),t.version=i.getUint32(n+4,_e);const s=i.getUint32(n+8,_e);return t.header={byteOffset:n,byteLength:s},g(2===t.version,`Invalid GLB version ${t.version}. Only supports v2.`),g(t.header.byteLength>Se+Ne),t.json={},t.binChunks=[],function(t,e,n,r){for(;n+8<=t.header.byteLength;){const i=e.getUint32(n+0,_e),s=e.getUint32(n+4,_e);switch(n+=Ne,s){case Ie:Pe(t,e,n,i,r);break;case Le:Ce(t,e,n,i,r);break;case Me:r.glb.strict||Pe(t,e,n,i,r);break;case je:r.glb.strict||Ce(t,e,n,i,r)}n+=$t(i)}}(t,i,n+Se,r),n+t.header.byteLength}function Pe(t,e,n,r,i){const s=new Uint8Array(e.buffer,n,r),o=new TextDecoder("utf8").decode(s);t.json=JSON.parse(o)}function Ce(t,e,n,r,i){t.header.hasBinChunk=!0,t.binChunks.push({byteOffset:n,byteLength:r,arrayBuffer:e.buffer})}const Be={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ue={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},De={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},Ve={magFilter:De.TEXTURE_MAG_FILTER,minFilter:De.TEXTURE_MIN_FILTER,wrapS:De.TEXTURE_WRAP_S,wrapT:De.TEXTURE_WRAP_T},Fe={[De.TEXTURE_MAG_FILTER]:De.LINEAR,[De.TEXTURE_MIN_FILTER]:De.NEAREST_MIPMAP_LINEAR,[De.TEXTURE_WRAP_S]:De.REPEAT,[De.TEXTURE_WRAP_]:De.REPEAT};class ze{postProcess(t,e={}){const{json:n,buffers:r=[],images:i=[],baseUri:s=""}=t;return Kt(n),this.baseUri=s,this.json=n,this.buffers=r,this.images=i,this._resolveTree(this.json,e),this.json}_resolveTree(t,e={}){t.bufferViews&&(t.bufferViews=t.bufferViews.map((t,e)=>this._resolveBufferView(t,e))),t.images&&(t.images=t.images.map((t,e)=>this._resolveImage(t,e))),t.samplers&&(t.samplers=t.samplers.map((t,e)=>this._resolveSampler(t,e))),t.textures&&(t.textures=t.textures.map((t,e)=>this._resolveTexture(t,e))),t.accessors&&(t.accessors=t.accessors.map((t,e)=>this._resolveAccessor(t,e))),t.materials&&(t.materials=t.materials.map((t,e)=>this._resolveMaterial(t,e))),t.meshes&&(t.meshes=t.meshes.map((t,e)=>this._resolveMesh(t,e))),t.nodes&&(t.nodes=t.nodes.map((t,e)=>this._resolveNode(t,e))),t.skins&&(t.skins=t.skins.map((t,e)=>this._resolveSkin(t,e))),t.scenes&&(t.scenes=t.scenes.map((t,e)=>this._resolveScene(t,e))),void 0!==t.scene&&(t.scene=t.scenes[this.json.scene])}getScene(t){return this._get("scenes",t)}getNode(t){return this._get("nodes",t)}getSkin(t){return this._get("skins",t)}getMesh(t){return this._get("meshes",t)}getMaterial(t){return this._get("materials",t)}getAccessor(t){return this._get("accessors",t)}getCamera(t){return null}getTexture(t){return this._get("textures",t)}getSampler(t){return this._get("samplers",t)}getImage(t){return this._get("images",t)}getBufferView(t){return this._get("bufferViews",t)}getBuffer(t){return this._get("buffers",t)}_get(t,e){if("object"==typeof e)return e;const n=this.json[t]&&this.json[t][e];return n||console.warn(`glTF file error: Could not find ${t}[${e}]`),n}_resolveScene(t,e){return t.id=t.id||`scene-${e}`,t.nodes=(t.nodes||[]).map(t=>this.getNode(t)),t}_resolveNode(t,e){return t.id=t.id||`node-${e}`,t.children&&(t.children=t.children.map(t=>this.getNode(t))),void 0!==t.mesh&&(t.mesh=this.getMesh(t.mesh)),void 0!==t.camera&&(t.camera=this.getCamera(t.camera)),void 0!==t.skin&&(t.skin=this.getSkin(t.skin)),t}_resolveSkin(t,e){return t.id=t.id||`skin-${e}`,t.inverseBindMatrices=this.getAccessor(t.inverseBindMatrices),t}_resolveMesh(t,e){return t.id=t.id||`mesh-${e}`,t.primitives&&(t.primitives=t.primitives.map(t=>{const e=(t={...t}).attributes;t.attributes={};for(const n in e)t.attributes[n]=this.getAccessor(e[n]);return void 0!==t.indices&&(t.indices=this.getAccessor(t.indices)),void 0!==t.material&&(t.material=this.getMaterial(t.material)),t})),t}_resolveMaterial(t,e){if(t.id=t.id||`material-${e}`,t.normalTexture&&(t.normalTexture={...t.normalTexture},t.normalTexture.texture=this.getTexture(t.normalTexture.index)),t.occlusionTexture&&(t.occlustionTexture={...t.occlustionTexture},t.occlusionTexture.texture=this.getTexture(t.occlusionTexture.index)),t.emissiveTexture&&(t.emmisiveTexture={...t.emmisiveTexture},t.emissiveTexture.texture=this.getTexture(t.emissiveTexture.index)),t.pbrMetallicRoughness){t.pbrMetallicRoughness={...t.pbrMetallicRoughness};const e=t.pbrMetallicRoughness;e.baseColorTexture&&(e.baseColorTexture={...e.baseColorTexture},e.baseColorTexture.texture=this.getTexture(e.baseColorTexture.index)),e.metallicRoughnessTexture&&(e.metallicRoughnessTexture={...e.metallicRoughnessTexture},e.metallicRoughnessTexture.texture=this.getTexture(e.metallicRoughnessTexture.index))}return t}_resolveAccessor(t,e){var n,r;if(t.id=t.id||`accessor-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView)),t.bytesPerComponent=(n=t.componentType,Ue[n]),t.components=(r=t.type,Be[r]),t.bytesPerElement=t.bytesPerComponent*t.components,t.bufferView){const e=t.bufferView.buffer,{ArrayType:n,length:r}=oe(t,t.bufferView),i=(t.bufferView.byteOffset||0)+e.byteOffset;t.value=new n(e.arrayBuffer,i,r)}return t}_resolveTexture(t,e){return t.id=t.id||`texture-${e}`,t.sampler="sampler"in t?this.getSampler(t.sampler):Fe,t.source=this.getImage(t.source),t}_resolveSampler(t,e){t.id=t.id||`sampler-${e}`,t.parameters={};for(const e in t){const n=this._enumSamplerParameter(e);void 0!==n&&(t.parameters[n]=t[e])}return t}_enumSamplerParameter(t){return Ve[t]}_resolveImage(t,e){t.id=t.id||`image-${e}`,void 0!==t.bufferView&&(t.bufferView=this.getBufferView(t.bufferView));const n=this.images[e];return n&&(t.image=n),t}_resolveBufferView(t,e){t.id=t.id||`bufferView-${e}`;const n=t.buffer;t.buffer=this.buffers[n];const r=this.buffers[n].arrayBuffer;let i=this.buffers[n].byteOffset||0;return"byteOffset"in t&&(i+=t.byteOffset),t.data=new Uint8Array(r,i,t.byteLength),t}_resolveCamera(t,e){return t.id=t.id||`camera-${e}`,t.perspective,t.orthographic,t}}async function qe(t,e,n=0,r,i){!function(t,e,n,r){r.uri&&(t.baseUri=r.uri);if(e instanceof ArrayBuffer&&!Re(e,n,r)){const t=new TextDecoder;e=t.decode(e)}if("string"==typeof e)t.json=Wt(e);else if(e instanceof ArrayBuffer){const i={};n=xe(i,e,n,r),Kt("glTF"===i.type,`Invalid GLB magic string ${i.type}`),t._glb=i,t.json=i.json}else Kt(!1,"GLTF: must be ArrayBuffer or string");const i=t.json.buffers||[];if(t.buffers=new Array(i.length).fill(null),t._glb&&t._glb.header.hasBinChunk){const{binChunks:e}=t._glb;t.buffers[0]={arrayBuffer:e[0].arrayBuffer,byteOffset:e[0].byteOffset,byteLength:e[0].byteLength}}const s=t.json.images||[];t.images=new Array(s.length).fill({})}(t,e,n,r);const s=[];if(r.gltf.loadImages){const e=async function(t,e,n){const r=t.json.images||[],i=[];for(let s=0;s<r.length;++s)i.push(Ge(t,r[s],s,e,n));return await Promise.all(i)}(t,r,i);s.push(e)}r.gltf.loadBuffers&&await async function(t,e,n){for(let r=0;r<t.json.buffers.length;++r){const i=t.json.buffers[r];if(i.uri){const{fetch:s}=n;Kt(s);const o=Qt(i.uri,e),a=await s(o),u=await a.arrayBuffer();t.buffers[r]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete i.uri}}}(t,r,i);const o=async function(t,e={},n){e.gltf=e.gltf||{};for(const r in ke){const i=e.gltf.excludeExtensions||{};if(!(r in i&&!i[r])){const i=ke[r];await i.decode(t,e,n)}}}(t,r,i);return s.push(o),await Promise.all(s),r.gltf.postProcess?function(t,e){return(new ze).postProcess(t,e)}(t,r):t}async function Ge(t,e,n,r,i){const{fetch:s,parse:o}=i;let a;if(e.uri){const t=Qt(e.uri,r),n=await s(t);a=await n.arrayBuffer()}if(Number.isFinite(e.bufferView)){const n=Xt(t.json,t.buffers,e.bufferView);a=Yt(n.buffer,n.byteOffset,n.byteLength)}Kt(a,"glTF image has no data");const u=await o(a,Gt,{},i);t.images[n]=u}const He={id:"gltf",name:"glTF",version:"2.1.1",extensions:["gltf","glb"],mimeType:"model/gltf+json",text:!0,binary:!0,test:"glTF",parse:async function(t,e={},n){(e={...He.options,...e}).gltf={...He.options.gltf,...e.gltf},function(t){"fetchImages"in t&&(t.gltf.loadImages=t.fetchImages);"createImages"in t&&(t.gltf.loadImages=t.createImages);"fetchLinkedResources"in t&&(t.gltf.fetchBuffers=t.fetchLinkedResources);"decompress"in t&&(t.gltf.decompressMeshes=t.decompress);"decompress"in t.gltf&&(t.gltf.decompressMeshes=t.gltf.decompress);"postProcess"in t&&(t.gltf.postProcess=t.postProcess)}(e);const{byteOffset:r=0}=e;return await qe({},t,r,e,n)},options:{gltf:{loadBuffers:!0,loadImages:!0,decompressMeshes:!0,postProcess:!0},uri:"",log:console}};var We=He;const $e={URI:0,EMBEDDED:1};function Ye(t,e,n){t.rotateYtoZ=!0;const r=t.byteOffset+t.byteLength-n;if(0===r)throw new Error("glTF byte length must be greater than 0.");return t.gltfArrayBuffer=Yt(e,n,r),t.gltfByteOffset=0,t.gltfByteLength=r,n%4==0||console.warn(`${t.type}: embedded glb is not aligned to a 4-byte boundary.`),t.byteOffset+t.byteLength}async function Ze(t,e,n,r){if(Ke(t,e,n),n.loadGLTF){const{parse:e,fetch:i}=r;t.gltfUrl&&(t.gltfArrayBuffer=await i(t.gltfUrl,n),t.gltfByteOffset=0),t.gltfArrayBuffer&&(t.gltf=await e(t.gltfArrayBuffer,We,n,r),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength)}}function Ke(t,e,n){switch(e){case $e.URI:const e=new Uint8Array(t.gltfArrayBuffer,t.gltfByteOffset),n=(new TextDecoder).decode(e);t.gltfUrl=n.replace(/[\s\0]+$/,""),delete t.gltfArrayBuffer,delete t.gltfByteOffset,delete t.gltfByteLength;break;case $e.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function Qe(t,e,n,r,i){n=function(t,e,n,r,i){n=rt(t,e,n),n=st(t,e,n),n=ot(t,e,n),n=Ye(t,e,n);const s=new G(t.featureTableJson,t.featureTableBinary);return t.rtcCenter=s.getGlobalProperty("RTC_CENTER",D.FLOAT,3),n}(t,e,n),await Ze(t,$e.EMBEDDED,r,i);const{extensions:s}=t.gltf||{};return s&&s.CESIUM_RTC&&(t.rtcCenter=s.CESIUM_RTC.center),n}var Xe=function(t){function e(){return Object(b.a)(this,e),Object(p.a)(this,Object(E.a)(e).apply(this,arguments))}return Object(O.a)(e,t),Object(m.a)(e,[{key:"toString",value:function(){var t="[";if(k.printRowMajor){t+="row-major:";for(var e=0;e<this.RANK;++e)for(var n=0;n<this.RANK;++n)t+=" ".concat(this[n*this.RANK+e])}else{t+="column-major:";for(var r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]"}},{key:"getElementIndex",value:function(t,e){return e*this.RANK+t}},{key:"getElement",value:function(t,e){return this[e*this.RANK+t]}},{key:"setElement",value:function(t,e,n){return this[e*this.RANK+t]=L(n),this}},{key:"getColumn",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array(this.RANK).fill(-0),n=t*this.RANK,r=0;r<this.RANK;++r)e[r]=this[n+r];return e}},{key:"setColumn",value:function(t,e){for(var n=t*this.RANK,r=0;r<this.RANK;++r)this[n+r]=e[r];return this}}]),e}(I),Je=n(0);function tn(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=n[0],y=n[1],d=n[2],g=n[3],v=n[4],b=n[5],m=n[6],p=n[7],E=n[8];return t[0]=l*r+y*o+d*c,t[1]=l*i+y*a+d*h,t[2]=l*s+y*u+d*f,t[3]=g*r+v*o+b*c,t[4]=g*i+v*a+b*h,t[5]=g*s+v*u+b*f,t[6]=m*r+p*o+E*c,t[7]=m*i+p*a+E*h,t[8]=m*s+p*u+E*f,t}function en(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}var nn=n(12),rn=Object.freeze([1,0,0,0,1,0,0,0,1]),sn=Object.freeze([0,0,0,0,0,0,0,0,0]),on=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL1ROW0:3,COL1ROW1:4,COL1ROW2:5,COL2ROW0:6,COL2ROW1:7,COL2ROW2:8}),an={},un=function(t){function e(t){var n;return Object(b.a)(this,e),n=Object(p.a)(this,Object(E.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(O.a)(e,t),Object(m.a)(e,[{key:"ELEMENTS",get:function(){return 9}},{key:"RANK",get:function(){return 3}},{key:"INDICES",get:function(){return on}}],[{key:"IDENTITY",get:function(){return an.IDENTITY=an.IDENTITY||Object.freeze(new e(rn)),an.IDENTITY}},{key:"ZERO",get:function(){return an.ZERO=an.ZERO||Object.freeze(new e(sn)),an.ZERO}}]),Object(m.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}},{key:"set",value:function(t,e,n,r,i,s,o,a,u){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,s,o,a,u){return this[0]=t,this[1]=r,this[2]=o,this[3]=e,this[4]=i,this[5]=a,this[6]=n,this[7]=s,this[8]=u,this.check()}},{key:"determinant",value:function(){return e=(t=this)[0],n=t[1],r=t[2],i=t[3],s=t[4],o=t[5],a=t[6],u=t[7],c=t[8],e*(c*s-o*u)+n*(-c*i+o*a)+r*(u*i-s*a);var t,e,n,r,i,s,o,a,u,c}},{key:"identity",value:function(){return this.copy(rn)}},{key:"fromQuaternion",value:function(t){return function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n+n,a=r+r,u=i+i,c=n*o,h=r*o,f=r*a,l=i*o,y=i*a,d=i*u,g=s*o,v=s*a,b=s*u;t[0]=1-f-d,t[3]=h-b,t[6]=l+v,t[1]=h+b,t[4]=1-c-d,t[7]=y-g,t[2]=l-v,t[5]=y+g,t[8]=1-c-f}(this,t),this.check()}},{key:"transpose",value:function(){return function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8]}(this,this),this.check()}},{key:"invert",value:function(){var t,e,n,r,i,s,o,a,u,c,h,f,l,y,d;return t=this,n=(e=this)[0],r=e[1],i=e[2],s=e[3],o=e[4],a=e[5],u=e[6],c=e[7],h=e[8],(d=n*(f=h*o-a*c)+r*(l=-h*s+a*u)+i*(y=c*s-o*u))&&(d=1/d,t[0]=f*d,t[1]=(-h*r+i*c)*d,t[2]=(a*r-i*o)*d,t[3]=l*d,t[4]=(h*n-i*u)*d,t[5]=(-a*n+i*s)*d,t[6]=y*d,t[7]=(-c*n+r*u)*d,t[8]=(o*n-r*s)*d),this.check()}},{key:"multiplyLeft",value:function(t){return tn(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return tn(this,this,t),this.check()}},{key:"rotate",value:function(t){var e,n,r,i,s,o,a,u,c,h,f,l,y,d;return e=this,r=t,i=(n=this)[0],s=n[1],o=n[2],a=n[3],u=n[4],c=n[5],h=n[6],f=n[7],l=n[8],y=Math.sin(r),d=Math.cos(r),e[0]=d*i+y*a,e[1]=d*s+y*u,e[2]=d*o+y*c,e[3]=d*a-y*i,e[4]=d*u-y*s,e[5]=d*c-y*o,e[6]=h,e[7]=f,e[8]=l,this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?en(this,this,t):en(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){var e,n,r,i,s,o,a,u,c,h,f,l,y,d;return e=this,r=t,i=(n=this)[0],s=n[1],o=n[2],a=n[3],u=n[4],c=n[5],h=n[6],f=n[7],l=n[8],y=r[0],d=r[1],e[0]=i,e[1]=s,e[2]=o,e[3]=a,e[4]=u,e[5]=c,e[6]=y*i+d*a+h,e[7]=y*s+d*u+f,e[8]=y*o+d*c+l,this.check()}},{key:"transform",value:function(t,e){switch(t.length){case 2:e=nn.c(e||[-0,-0],t,this);break;case 3:e=x.l(e||[-0,-0,-0],t,this);break;case 4:n=e||[-0,-0,-0,-0],i=this,s=(r=t)[0],o=r[1],a=r[2],n[0]=i[0]*s+i[3]*o+i[6]*a,n[1]=i[1]*s+i[4]*o+i[7]*a,n[2]=i[2]*s+i[5]*o+i[8]*a,n[3]=r[3],e=n;break;default:throw new Error("Illegal vector")}var n,r,i,s,o,a;return M(e,t.length),e}},{key:"transformVector",value:function(t,e){return _("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector2",value:function(t,e){return _("Matrix3.transformVector"),this.transform(t,e)}},{key:"transformVector3",value:function(t,e){return _("Matrix3.transformVector"),this.transform(t,e)}}]),e}(Xe),cn=n(11);function hn(){var t=new Je.a(4);return Je.a!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function fn(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function ln(t,e,n){var r=e[0],i=e[1],s=e[2],o=e[3],a=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+o*a+i*c-s*u,t[1]=i*h+o*u+s*a-r*c,t[2]=s*h+o*c+r*u-i*a,t[3]=o*h-r*a-i*u-s*c,t}function yn(t,e,n,r){var i,s,o,a,u,c=e[0],h=e[1],f=e[2],l=e[3],y=n[0],d=n[1],g=n[2],v=n[3];return(s=c*y+h*d+f*g+l*v)<0&&(s=-s,y=-y,d=-d,g=-g,v=-v),1-s>Je.b?(i=Math.acos(s),o=Math.sin(i),a=Math.sin((1-r)*i)/o,u=Math.sin(r*i)/o):(a=1-r,u=r),t[0]=a*c+u*y,t[1]=a*h+u*d,t[2]=a*f+u*g,t[3]=a*l+u*v,t}function dn(t,e){var n,r=e[0]+e[4]+e[8];if(r>0)n=Math.sqrt(r+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var s=(i+1)%3,o=(i+2)%3;n=Math.sqrt(e[3*i+i]-e[3*s+s]-e[3*o+o]+1),t[i]=.5*n,n=.5/n,t[3]=(e[3*s+o]-e[3*o+s])*n,t[s]=(e[3*s+i]+e[3*i+s])*n,t[o]=(e[3*o+i]+e[3*i+o])*n}return t}cn.b,cn.g,cn.c,cn.l;var gn,vn,bn,mn,pn,En,On,Tn=cn.a,wn=cn.k,kn=cn.d,An=cn.i,Sn=cn.h,Nn=cn.m,In=cn.j,Ln=(cn.f,cn.e,gn=x.b(),vn=x.e(1,0,0),bn=x.e(0,1,0),function(t,e,n){var r=x.d(e,n);return r<-.999999?(x.c(gn,vn,e),x.f(gn)<1e-6&&x.c(gn,bn,e),x.h(gn,gn),fn(t,gn,Math.PI),t):r>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(x.c(gn,e,n),t[0]=gn[0],t[1]=gn[1],t[2]=gn[2],t[3]=1+r,In(t,t))}),Mn=(mn=hn(),pn=hn(),En=new Je.a(9),Je.a!=Float32Array&&(En[1]=0,En[2]=0,En[3]=0,En[5]=0,En[6]=0,En[7]=0),En[0]=1,En[4]=1,En[8]=1,On=En,[0,0,0,1]),jn=function(t){function e(){var t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(b.a)(this,e),t=Object(p.a)(this,Object(E.a)(e).call(this,-0,-0,-0,-0)),Array.isArray(n)&&1===arguments.length?t.copy(n):t.set(n,r,i,s),t}return Object(O.a)(e,t),Object(m.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}},{key:"set",value:function(t,e,n,r){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this.check()}},{key:"fromMatrix3",value:function(t){return dn(this,t),this.check()}},{key:"identity",value:function(){return function(t){t[0]=0,t[1]=0,t[2]=0,t[3]=1}(this),this.check()}},{key:"fromAxisRotation",value:function(t,e){return fn(this,t,e),this.check()}},{key:"setAxisAngle",value:function(t,e){return this.fromAxisRotation(t,e)}},{key:"len",value:function(){return Sn(this)}},{key:"lengthSquared",value:function(t){return Nn(this)}},{key:"dot",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.dot only takes one argument");return kn(this,t)}},{key:"rotationTo",value:function(t,e){return Ln(this,t,e),this.check()}},{key:"add",value:function(t,e){if(void 0!==e)throw new Error("Quaternion.add only takes one argument");return Tn(this,this,t),this.check()}},{key:"calculateW",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2];t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i))}(this,this),this.check()}},{key:"conjugate",value:function(){return function(t,e){t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3]}(this,this),this.check()}},{key:"invert",value:function(){return function(t,e){var n=e[0],r=e[1],i=e[2],s=e[3],o=n*n+r*r+i*i+s*s,a=o?1/o:0;t[0]=-n*a,t[1]=-r*a,t[2]=-i*a,t[3]=s*a}(this,this),this.check()}},{key:"lerp",value:function(t,e,n){return An(this,t,e,n),this.check()}},{key:"multiplyRight",value:function(t,e){return w(!e),ln(this,this,t),this.check()}},{key:"multiplyLeft",value:function(t,e){return w(!e),ln(this,t,this),this.check()}},{key:"normalize",value:function(){var t=this.len(),e=t>0?1/t:0;return this[0]=this[0]*e,this[1]=this[1]*e,this[2]=this[2]*e,this[3]=this[3]*e,0===t&&(this[3]=1),this.check()}},{key:"rotateX",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+o*a,t[1]=i*u+s*a,t[2]=s*u-i*a,t[3]=o*u-r*a}(this,this,t),this.check()}},{key:"rotateY",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u-s*a,t[1]=i*u+o*a,t[2]=s*u+r*a,t[3]=o*u-i*a}(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return function(t,e,n){n*=.5;var r=e[0],i=e[1],s=e[2],o=e[3],a=Math.sin(n),u=Math.cos(n);t[0]=r*u+i*a,t[1]=i*u-r*a,t[2]=s*u+o*a,t[3]=o*u-s*a}(this,this,t),this.check()}},{key:"scale",value:function(t){return wn(this,this,t),this.check()}},{key:"slerp",value:function(t,e,n){switch(arguments.length){case 1:var r=arguments[0],i=r.start;t=void 0===i?Mn:i,e=r.target,n=r.ratio;break;case 2:var s=Array.prototype.slice.call(arguments);e=s[0],n=s[1],t=this}return yn(this,t,e,n),this.check()}},{key:"transformVector4",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;return cn.o(e,t,this),M(e,4)}},{key:"lengthSq",value:function(){return this.lengthSquared()}},{key:"setFromAxisAngle",value:function(t,e){return this.setAxisAngle(t,e)}},{key:"premultiply",value:function(t,e){return this.multiplyLeft(t,e)}},{key:"multiply",value:function(t,e){return this.multiplyRight(t,e)}},{key:"ELEMENTS",get:function(){return 4}},{key:"x",get:function(){return this[0]},set:function(t){return this[0]=L(t)}},{key:"y",get:function(){return this[1]},set:function(t){return this[1]=L(t)}},{key:"z",get:function(){return this[2]},set:function(t){return this[2]=L(t)}},{key:"w",get:function(){return this[3]},set:function(t){return this[3]=L(t)}}]),e}(I),_n=n(20),Rn=n(4),xn=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),Pn=Object.freeze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Cn=Object.freeze({COL0ROW0:0,COL0ROW1:1,COL0ROW2:2,COL0ROW3:3,COL1ROW0:4,COL1ROW1:5,COL1ROW2:6,COL1ROW3:7,COL2ROW0:8,COL2ROW1:9,COL2ROW2:10,COL2ROW3:11,COL3ROW0:12,COL3ROW1:13,COL3ROW2:14,COL3ROW3:15}),Bn={},Un=function(t){function e(t){var n;return Object(b.a)(this,e),n=Object(p.a)(this,Object(E.a)(e).call(this,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0)),1===arguments.length&&Array.isArray(t)?n.copy(t):n.identity(),n}return Object(O.a)(e,t),Object(m.a)(e,[{key:"INDICES",get:function(){return Cn}},{key:"ELEMENTS",get:function(){return 16}},{key:"RANK",get:function(){return 4}}],[{key:"IDENTITY",get:function(){return Bn.IDENTITY=Bn.IDENTITY||Object.freeze(new e(xn)),Bn.IDENTITY}},{key:"ZERO",get:function(){return Bn.ZERO=Bn.ZERO||Object.freeze(new e(Pn)),Bn.ZERO}}]),Object(m.a)(e,[{key:"copy",value:function(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}},{key:"set",value:function(t,e,n,r,i,s,o,a,u,c,h,f,l,y,d,g){return this[0]=t,this[1]=e,this[2]=n,this[3]=r,this[4]=i,this[5]=s,this[6]=o,this[7]=a,this[8]=u,this[9]=c,this[10]=h,this[11]=f,this[12]=l,this[13]=y,this[14]=d,this[15]=g,this.check()}},{key:"setRowMajor",value:function(t,e,n,r,i,s,o,a,u,c,h,f,l,y,d,g){return this[0]=t,this[1]=i,this[2]=u,this[3]=l,this[4]=e,this[5]=s,this[6]=c,this[7]=y,this[8]=n,this[9]=o,this[10]=h,this[11]=d,this[12]=r,this[13]=a,this[14]=f,this[15]=g,this.check()}},{key:"toRowMajor",value:function(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}},{key:"identity",value:function(){return this.copy(xn)}},{key:"fromQuaternion",value:function(t){return Rn.b(this,t),this.check()}},{key:"frustum",value:function(t){var n=t.left,r=t.right,i=t.bottom,s=t.top,o=t.near,a=t.far;return a===1/0?e._computeInfinitePerspectiveOffCenter(this,n,r,i,s,o):Rn.c(this,n,r,i,s,o,a),this.check()}},{key:"lookAt",value:function(t,e,n){if(1===arguments.length){var r=t;t=r.eye,e=r.center,n=r.up}return e=e||[0,0,0],n=n||[0,1,0],Rn.e(this,t,e,n),this.check()}},{key:"ortho",value:function(t){var e=t.left,n=t.right,r=t.bottom,i=t.top,s=t.near,o=void 0===s?.1:s,a=t.far,u=void 0===a?500:a;return Rn.g(this,e,n,r,i,o,u),this.check()}},{key:"orthographic",value:function(t){var n=t.fovy,r=void 0===n?45*Math.PI/180:n,i=t.aspect,s=void 0===i?1:i,o=t.focalDistance,a=void 0===o?1:o,u=t.near,c=void 0===u?.1:u,h=t.far,f=void 0===h?500:h;if(r>2*Math.PI)throw Error("radians");var l=r/2,y=a*Math.tan(l),d=y*s;return(new e).ortho({left:-d,right:d,bottom:-y,top:y,near:c,far:f})}},{key:"perspective",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.fovy,n=t.fov,r=void 0===n?45*Math.PI/180:n,i=t.aspect,s=void 0===i?1:i,o=t.near,a=void 0===o?.1:o,u=t.far,c=void 0===u?500:u;if((e=e||r)>2*Math.PI)throw Error("radians");return Rn.h(this,e,s,a,c),this.check()}},{key:"determinant",value:function(){return Rn.a(this)}},{key:"getScale",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}},{key:"getTranslation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0];return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}},{key:"getRotation",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=0,t[4]=this[4]*r,t[5]=this[5]*i,t[6]=this[6]*s,t[7]=0,t[8]=this[8]*r,t[9]=this[9]*i,t[10]=this[10]*s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}},{key:"getRotationMatrix3",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[-0,-0,-0,-0,-0,-0,-0,-0,-0],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this.getScale(e||[-0,-0,-0]),r=1/n[0],i=1/n[1],s=1/n[2];return t[0]=this[0]*r,t[1]=this[1]*i,t[2]=this[2]*s,t[3]=this[4]*r,t[4]=this[5]*i,t[5]=this[6]*s,t[6]=this[8]*r,t[7]=this[9]*i,t[8]=this[10]*s,t}},{key:"transpose",value:function(){return Rn.o(this,this),this.check()}},{key:"invert",value:function(){return Rn.d(this,this),this.check()}},{key:"multiplyLeft",value:function(t){return Rn.f(this,t,this),this.check()}},{key:"multiplyRight",value:function(t){return Rn.f(this,this,t),this.check()}},{key:"rotateX",value:function(t){return Rn.j(this,this,t),this.check()}},{key:"rotateY",value:function(t){return Rn.k(this,this,t),this.check()}},{key:"rotateZ",value:function(t){return Rn.l(this,this,t),this.check()}},{key:"rotateXYZ",value:function(t){var e=Object(_n.a)(t,3),n=e[0],r=e[1],i=e[2];return this.rotateX(n).rotateY(r).rotateZ(i)}},{key:"rotateAxis",value:function(t,e){return Rn.i(this,this,t,e),this.check()}},{key:"scale",value:function(t){return Array.isArray(t)?Rn.m(this,this,t):Rn.m(this,this,[t,t,t]),this.check()}},{key:"translate",value:function(t){return Rn.n(this,this,t),this.check()}},{key:"transform",value:function(t,e){return 4===t.length?(M(e=cn.n(e||[-0,-0,-0,-0],t,this),4),e):this.transformAsPoint(t,e)}},{key:"transformAsPoint",value:function(t,e){switch(t.length){case 2:e=nn.d(e||[-0,-0],t,this);break;case 3:e=x.m(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return M(e,t.length),e}},{key:"transformAsVector",value:function(t,e){switch(t.length){case 2:e=function(t,e,n){var r=e[0],i=e[1],s=n[3]*r+n[7]*i||1;return t[0]=(n[0]*r+n[4]*i)/s,t[1]=(n[1]*r+n[5]*i)/s,t}(e||[-0,-0],t,this);break;case 3:e=P(e||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return M(e,t.length),e}},{key:"makeRotationX",value:function(t){return this.identity().rotateX(t)}},{key:"makeTranslation",value:function(t,e,n){return this.identity().translate([t,e,n])}},{key:"transformPoint",value:function(t,e){return _("Matrix4.transformPoint","3.0"),this.transformAsPoint(t,e)}},{key:"transformVector",value:function(t,e){return _("Matrix4.transformVector","3.0"),this.transformAsPoint(t,e)}},{key:"transformDirection",value:function(t,e){return _("Matrix4.transformDirection","3.0"),this.transformAsVector(t,e)}}],[{key:"_computeInfinitePerspectiveOffCenter",value:function(t,e,n,r,i,s){var o=2*s/(n-e),a=2*s/(i-r),u=(n+e)/(n-e),c=(i+r)/(i-r),h=-2*s;return t[0]=o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=u,t[9]=c,t[10]=-1,t[11]=-1,t[12]=0,t[13]=0,t[14]=h,t[15]=0,t}}]),e}(Xe),Dn=(Math.max(6378137,6378137,6356752.314245179),function(t){return t}),Vn=new ct.c;function Fn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dn;return Object(ct.i)(t)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in t?(e[0]=n(t.longitude),e[1]=n(t.latitude),e[2]=t.height):(e[0]=n(t.x),e[1]=n(t.y),e[2]=t.z),e}function zn(t){return Fn(t,arguments.length>1&&void 0!==arguments[1]?arguments[1]:Vn,ct.g.cartographicRadians?Dn:ct.k)}function qn(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Dn;return Object(ct.i)(e)?(e[0]=n(t[0]),e[1]=n(t[1]),e[2]=t[2]):"longitude"in e?(e.longitude=n(t[0]),e.latitude=n(t[1]),e.height=t[2]):(e.x=n(t[0]),e.y=n(t[1]),e.z=t[2]),e}function Gn(t,e){return qn(t,e,ct.g.cartographicRadians?Dn:ct.j)}var Hn=new ct.c,Wn=new ct.c,$n=new ct.c;var Yn=1e-14,Zn=new ct.c,Kn={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Qn={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Xn={east:new ct.c,north:new ct.c,up:new ct.c,west:new ct.c,south:new ct.c,down:new ct.c},Jn=new ct.c,tr=new ct.c,er=new ct.c;function nr(t,e,n,r,i,s){var o,a,u,c=Kn[e]&&Kn[e][n];Object(ct.e)(c&&(!r||r===c));var h=Zn.copy(i);if(Object(ct.h)(h.x,0,Yn)&&Object(ct.h)(h.y,0,Yn)){var f=Math.sign(h.z);o=Jn.fromArray(Qn[e]),"east"!==e&&"west"!==e&&o.scale(f),a=tr.fromArray(Qn[n]),"east"!==n&&"west"!==n&&a.scale(f),u=er.fromArray(Qn[r]),"east"!==r&&"west"!==r&&u.scale(f)}else{var l=Xn.up,y=Xn.east,d=Xn.north;y.set(-h.y,h.x,0).normalize(),t.geodeticSurfaceNormal(h,l),d.copy(l).cross(y);var g=Xn.down,v=Xn.west,b=Xn.south;g.copy(l).scale(-1),v.copy(y).scale(-1),b.copy(d).scale(-1),o=Xn[e],a=Xn[n],u=Xn[r]}return s[0]=o.x,s[1]=o.y,s[2]=o.z,s[3]=0,s[4]=a.x,s[5]=a.y,s[6]=a.z,s[7]=0,s[8]=u.x,s[9]=u.y,s[10]=u.z,s[11]=0,s[12]=h.x,s[13]=h.y,s[14]=h.z,s[15]=1,s}var rr,ir=new ct.c,sr=new ct.c,or=new ct.c,ar=new ct.c,ur=new ct.c,cr=new ct.c,hr=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(b.a)(this,t),Object(ct.e)(e>=0),Object(ct.e)(n>=0),Object(ct.e)(r>=0),this.radii=new ct.c(e,n,r),this.radiiSquared=new ct.c(e*e,n*n,r*r),this.radiiToTheFourth=new ct.c(e*e*e*e,n*n*n*n,r*r*r*r),this.oneOverRadii=new ct.c(0===e?0:1/e,0===n?0:1/n,0===r?0:1/r),this.oneOverRadiiSquared=new ct.c(0===e?0:1/(e*e),0===n?0:1/(n*n),0===r?0:1/(r*r)),this.minimumRadius=Math.min(e,n,r),this.maximumRadius=Math.max(e,n,r),this.centerToleranceSquared=ct.d.EPSILON1,0!==this.radiiSquared.z&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}return Object(m.a)(t,null,[{key:"WGS84",get:function(){return rr=rr||new t(6378137,6378137,6356752.314245179)}}]),Object(m.a)(t,[{key:"equals",value:function(t){return this===t||Boolean(t&&this.radii.equals(t.radii))}},{key:"toString",value:function(){return this.radii.toString()}},{key:"cartographicToCartesian",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=sr,r=or,i=Object(_n.a)(t,3),s=i[2];this.geodeticSurfaceNormalCartographic(t,n),r.copy(this.radiiSquared).scale(n);var o=Math.sqrt(n.dot(r));return r.scale(1/o),n.scale(s),r.add(n),r.to(e)}},{key:"cartesianToCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];cr.from(t);var n=this.scaleToGeodeticSurface(cr,ar);if(n){var r=this.geodeticSurfaceNormal(n,sr),i=ur;i.copy(cr).subtract(n);var s=Math.atan2(r.y,r.x),o=Math.asin(r.z),a=Math.sign(x.d(i,cr))*x.g(i);return Gn([s,o,a],e)}}},{key:"eastNorthUpToFixedFrame",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ct.a;return nr(this,"east","north","up",t,e)}},{key:"localFrameToFixedFrame",value:function(t,e,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ct.a;return nr(this,t,e,n,r,i)}},{key:"geocentricSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ir.from(t).normalize().to(e)}},{key:"geodeticSurfaceNormalCartographic",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=zn(t),r=n[0],i=n[1],s=Math.cos(i);return ir.set(s*Math.cos(r),s*Math.sin(r),Math.sin(i)).normalize(),ir.to(e)}},{key:"geodeticSurfaceNormal",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ir.from(t).scale(this.oneOverRadiiSquared).normalize().to(e)}},{key:"scaleToGeodeticSurface",value:function(t,e){return function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ct.c,r=e.oneOverRadii,i=e.oneOverRadiiSquared,s=e.centerToleranceSquared;Hn.from(t);var o=t.x,a=t.y,u=t.z,c=r.x,h=r.y,f=r.z,l=o*o*c*c,y=a*a*h*h,d=u*u*f*f,g=l+y+d,v=Math.sqrt(1/g);if(Number.isFinite(v)){var b=Wn;if(b.copy(t).scale(v),g<s)return b.to(n);var m=i.x,p=i.y,E=i.z,O=$n;O.set(b.x*m*2,b.y*p*2,b.z*E*2);var T,w,k,A,S=(1-v)*t.len()/(.5*O.len()),N=0;do{var I=(T=1/(1+(S-=N)*m))*T,L=(w=1/(1+S*p))*w,M=(k=1/(1+S*E))*k;N=(A=l*I+y*L+d*M-1)/(-2*(l*(I*T)*m+y*(L*w)*p+d*(M*k)*E))}while(Math.abs(A)>ct.d.EPSILON12);return Hn.scale([T,w,k]).to(n)}}(t,this,e)}},{key:"scaleToGeocentricSurface",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];ar.from(t);var n=ar.x,r=ar.y,i=ar.z,s=this.oneOverRadiiSquared,o=1/Math.sqrt(n*n*s.x+r*r*s.y+i*i*s.z);return ar.multiplyScalar(o).to(e)}},{key:"transformPositionToScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ar.from(t).scale(this.oneOverRadii).to(e)}},{key:"transformPositionFromScaledSpace",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return ar.from(t).scale(this.radii).to(e)}},{key:"getSurfaceNormalIntersectionWithZAxis",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[0,0,0];Object(ct.e)(Object(ct.h)(this.radii.x,this.radii.y,ct.d.EPSILON15)),Object(ct.e)(this.radii.z>0),ar.from(t);var r=ar.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(r)>=this.radii.z-e))return ar.set(0,0,r).to(n)}}]),t}();async function fr(t,e,n,r,i){return n=function(t,e,n,r,i){if(n=rt(t,e,n),1!==t.version)throw new Error(`Instanced 3D Model version ${t.version} is not supported`);n=st(t,e,n);const s=new DataView(e);if(t.gltfFormat=s.getUint32(n,!0),n=ot(t,e,n+=4),n=Ye(t,e,n),0===t.featureTableJsonByteLength)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new G(t.featureTableJson,t.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");t.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),t.rtcCenter=o.getGlobalProperty("RTC_CENTER",D.FLOAT,3);new et(t.batchTableJson,t.batchTableBinary,a);return function(t,e,n,r){const i=[new Array(r),t._batchTable][0],s=new B,o=new B,a=new B,u=new B,c=new un,h=new jn,f=new B,l={},y=new Un,d=[],g=[],v=new B,b=new B;for(let n=0;n<r;n++){let r;if(e.hasProperty("POSITION"))r=e.getProperty("POSITION",D.FLOAT,3,n,s);else if(e.hasProperty("POSITION_QUANTIZED")){r=e.getProperty("POSITION_QUANTIZED",D.UNSIGNED_SHORT,3,n,s);const t=e.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",D.FLOAT,3,v);if(!t)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const i=e.getGlobalProperty("QUANTIZED_VOLUME_SCALE",D.FLOAT,3,b);if(!i)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const o=65535;for(let e=0;e<3;e++)r[e]=r[e]/o*i[e]+t[e]}if(!r)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");s.copy(r),l.translation=s,t.normalUp=e.getProperty("NORMAL_UP",D.FLOAT,3,n,d),t.normalRight=e.getProperty("NORMAL_RIGHT",D.FLOAT,3,n,g);const m=!1;if(t.normalUp){if(!t.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");t.hasCustomOrientation=!0}else{if(t.octNormalUp=e.getProperty("NORMAL_UP_OCT32P",D.UNSIGNED_SHORT,2,d),t.octNormalRight=e.getProperty("NORMAL_RIGHT_OCT32P",D.UNSIGNED_SHORT,2,g),t.octNormalUp){if(!t.octNormalRight)throw new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");throw new Error("i3dm: oct-encoded orientation not implemented")}t.eastNorthUp?(hr.WGS84.eastNorthUpToFixedFrame(s,y),y.getRotationMatrix3(c)):c.identity()}m&&(u.copy(o).cross(a).normalize(),c.setColumn(0,o),c.setColumn(1,a),c.setColumn(2,u)),h.fromMatrix3(c),l.rotation=h,f.set(1,1,1);const p=e.getProperty("SCALE",D.FLOAT,1,n);Number.isFinite(p)&&f.multiplyByScalar(p);const E=e.getProperty("SCALE_NON_UNIFORM",D.FLOAT,3,n,d);E&&f.scale(E),l.scale=f;let O=e.getProperty("BATCH_ID",D.UNSIGNED_SHORT,1,n);void 0===O&&(O=n);const T=(new Un).fromQuaternion(l.rotation);y.identity(),y.translate(l.translation),y.multiplyRight(T),y.scale(l.scale);const w=y.clone();i[n]={modelMatrix:w,batchId:O}}t.instances=i}(t,o,0,a),n}(t,e,n),await Ze(t,t.gltfFormat,r,i),n}async function lr(t,e=0,n,r,i={}){switch(n=n["3d-tiles"]||{},i.byteOffset=e,i.type=function(t,e=0){const n=new DataView(t);return`${String.fromCharCode(n.getUint8(e+0))}${String.fromCharCode(n.getUint8(e+1))}${String.fromCharCode(n.getUint8(e+2))}${String.fromCharCode(n.getUint8(e+3))}`}(t,e),i.type){case y.COMPOSITE:return await async function(t,e,n,r,i,s){n=rt(t,e,n);const o=new DataView(e);for(t.tilesLength=o.getUint32(n,!0),n+=4,t.tiles=[];t.tiles.length<t.tilesLength&&t.byteLength-n>12;){const o={};t.tiles.push(o),n=await s(e,n,r,i,o)}return n}(i,t,e,n,r,lr);case y.BATCHED_3D_MODEL:return await Qe(i,t,e,n,r);case y.INSTANCED_3D_MODEL:return await fr(i,t,e,n,r);case y.POINT_CLOUD:return await bt(i,t,e,n,r);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}function yr(t,e){return t.content&&(t.contentUrl=`${e.basePath}/${t.content.uri}`),t.id=t.contentUrl,t.lodMetricType=l.GEOMETRIC_ERROR,t.lodMetricValue=t.geometricError,t.transformMatrix=t.transform,t.type=function(t){if(!t.contentUrl)return h.EMPTY;const e=t.contentUrl.split(".").pop();switch(e){case"pnts":return h.POINTCLOUD;case"i3dm":case"b3dm":return h.SCENEGRAPH;default:return e}}(t),t.refine=function(t){switch(t){case"REPLACE":case"replace":return c.REPLACE;case"ADD":case"add":return c.ADD;default:return t}}(t.refine),t}async function dr(t,e,n){const i=JSON.parse((new TextDecoder).decode(t));var s;return i.loader=e.loader||gr,i.url=n.url,i.basePath=(s=i,r.dirname(s.url)),i.root=function(t){const e=t.basePath,n=yr(t.root,t),r=[];for(r.push(n);r.length>0;){const t=r.pop().children||[];for(const n of t)yr(n,{basePath:e}),r.push(n)}return n}(i),i.type=f.TILES3D,i.lodMetricType=l.GEOMETRIC_ERROR,i.lodMetricValue=i.root.lodMetricValue,i}const gr={id:"3d-tiles",name:"3D Tiles",version:"2.1.1",extensions:["json","cmpt","pnts","b3dm","i3dm"],mimeType:"application/octet-stream",test:["json","cmpt","pnts","b3dm","i3dm"],parse:async function(t,e,n,r){let i;return i="isTileset"in(e["3d-tiles"]||{})?e.isTileset:n.url&&-1!==n.url.indexOf(".json"),t=i?await dr(t,e,n):await async function(t,e,n){const r={};return r.content=r.content||{},await lr(t,0,e,n,r.content),r.content}(t,e,n)},options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1}}};var vr=gr;let br="";const mr={};const pr=t=>(t=>"undefined"!=typeof File&&t instanceof File)(t)||(t=>"undefined"!=typeof Blob&&t instanceof Blob)(t);class Er{constructor(t,e){this._fileOrBlob=t,this.bodyUsed=!1}get headers(){return new Headers({"Content-Length":this._fileOrBlob.size,"Content-Type":this._fileOrBlob.type})}get ok(){return!0}get status(){return 200}get url(){return this._fileOrBlob.name||""}async arrayBuffer(){const{reader:t,promise:e}=this._getFileReader();return t.readAsArrayBuffer(this._fileOrBlob),e}async text(){const{reader:t,promise:e}=this._getFileReader();return t.readAsText(this._fileOrBlob),e}async json(){const t=await this.text();return JSON.parse(t)}_getFileReader(){g(!this.bodyUsed),this.bodyUsed=!0;const t=new FileReader,e=new Promise((e,n)=>{try{t.onerror=t=>n(new Error("Read error")),t.onabort=()=>n(new Error("Read aborted.")),t.onload=()=>e(t.result)}catch(t){n(t)}});return{reader:t,promise:e}}}async function Or(t,e){if(pr(t))return function(t,e){return Promise.resolve(new Er(t,e))}(t,e);t=function(t){for(const e in mr)if(t.startsWith(e)){const n=mr[e];return t.replace(e,n)}return t+=br}(t);const n=await fetch(t,e);if(!n.ok&&e.throws)throw new Error(await async function(t){let e=`Failed to fetch resource ${t.url} (${t.status}): `;try{t.headers.get("Content-Type").includes("application/json")?e+=await t.text():e+=t.statusText}catch(t){return e}return e}(n));return n}const Tr="https://api.cesium.com/v1/assets";async function wr(t,e){if(!e){const n=await async function(t){g(t);const e=Tr,n={Authorization:`Bearer ${t}`},r=await Or(e,{headers:n,throws:!0});return await r.json()}(t);for(const t of n.items)"3DTILES"===t.type&&(e=t.id)}const n=await async function(t,e){g(t,e);const n={Authorization:`Bearer ${t}`},r=`${Tr}/${e}`;let i=await Or(`${r}`,{headers:n,throws:!0}),s=await i.json();i=await Or(`${r}/endpoint`,{headers:n,throws:!0});const o=await i.json();return s={...s,...o},s}(t,e),{type:r,url:i}=n;return g("3DTILES"===r&&i),n.headers={Authorization:`Bearer ${n.accessToken}`},n}const kr={...vr,id:"cesium-ion",name:"Cesium Ion",preload:async function(t,e={}){e=e["cesium-ion"]||{};const{accessToken:n}=e;let r=e.assetId;if(!Number.isFinite(r)){const e=t.match(/\/([0-9]+)\/tileset.json/);r=e&&e[1]}return wr(n,r)},parse:async(t,e,n,r)=>(e["3d-tiles"]=e["cesium-ion"],e.loader=kr,vr.parse(t,e,n,r)),options:{"cesium-ion":vr.options["3d-tiles"]}};var Ar=kr;function Sr(t,e,n){if(!e)return n+12;const{magic:r,version:i=1,byteLength:s=12}=t;return g(Array.isArray(r)&&Number.isFinite(i)&&Number.isFinite(s)),e.setUint8(n+0,r[0]),e.setUint8(n+1,r[1]),e.setUint8(n+2,r[2]),e.setUint8(n+3,r[3]),e.setUint32(n+4,i,!0),e.setUint32(n+8,s,!0),n+=12}function Nr(t,e,n){t&&t.setUint32(e+8,n,!0)}function Ir(t,e,n,r){if(t)for(let i=0;i<r;i++)t.setUint8(e+i,n.charCodeAt(i));return e+r}const Lr={POINTS_LENGTH:1,POSITIONS:{byteOffset:0}};function Mr(t,e,n,r){const{featureTableJson:i=Lr}=t;let s=JSON.stringify(i);s=function(t,e){const n=t.length,r=Math.ceil(n/e)*e-n;let i="";for(let t=0;t<r;++t)i+=" ";return t+i}(s,4);const{featureTableJsonByteLength:o=s.length}=t,a=new ArrayBuffer(12),u=a.byteLength,c=n;return n+=Sr(t={magic:d.POINT_CLOUD,...t},e,0),e&&(e.setUint32(n+0,o,!0),e.setUint32(n+4,u,!0),e.setUint32(n+8,0,!0),e.setUint32(n+12,0,!0)),n+=16,n+=Ir(e,n,s,o),n+=function(t,e,n,r){if(t)for(let i=0;i<r;i++)t.setUint8(e+i,n[i]),e++;return e+r}(e,n,a,u),Nr(e,c,n-c),n}function jr(t,e,n,r){switch(g("string"==typeof t.type),t.type){case y.COMPOSITE:return function(t,e,n,r,i){const s=n;n+=Sr(t={magic:d.COMPOSITE,tiles:[],...t},e,n),e&&e.setUint32(n,t.tiles.length,!0),n+=4;for(let s=0;s<t.tiles.length;++s)n+=i(t.tiles[s],e,n,r);return Nr(e,s,n-s),n}(t,e,n,r,jr);case y.POINT_CLOUD:return Mr(t,e,n);case y.BATCHED_3D_MODEL:return function(t,e,n,r){const{featuresLength:i=1}=t,s={BATCH_LENGTH:i},o=JSON.stringify(s),a=o.length,u=n;return n=Sr(t={magic:d.BATCHED_MODEL,...t},e,n),e&&(e.setUint32(12,a,!0),e.setUint32(16,0,!0),e.setUint32(20,0,!0),e.setUint32(24,0,!0)),n+=16,Nr(e,u,(n+=Ir(e,n,o,a))-u),n}(t,e,n);case y.INSTANCED_3D_MODEL:return function(t,e,n,r){const{featuresLength:i=1,gltfFormat:s=1,gltfUri:o=""}=t,a=o.length,u={INSTANCES_LENGTH:i,POSITION:new Array(3*i).fill(0)},c=JSON.stringify(u),h=c.length,f=n;return Sr(t={magic:d.INSTANCED_MODEL,...t},e,0),e&&(e.setUint32(12,h,!0),e.setUint32(16,0,!0),e.setUint32(20,0,!0),e.setUint32(24,0,!0),e.setUint32(28,s,!0)),n+=Ir(e,n,c,h),Nr(e,f,(n+=Ir(e,n,o,a))-f),n}(t,e,n);default:throw new Error("3D Tiles: unknown tile type")}}var _r={name:"GLB",extensions:["cmpt","pnts","b3dm","i3dm"],mimeType:"application/octet-stream",encodeSync:function(t,e){return function(t,e){const n=jr(t,null,0,e),r=new ArrayBuffer(n);return jr(t,new DataView(r),0,e),r}(t,e)},binary:!0};n.d(e,"Tiles3DLoader",(function(){return vr})),n.d(e,"CesiumIonLoader",(function(){return Ar})),n.d(e,"Tile3DWriter",(function(){return _r})),n.d(e,"Tile3DFeatureTable",(function(){return G})),n.d(e,"Tile3DBatchTable",(function(){return et})),n.d(e,"TILE3D_TYPE",(function(){return y})),n.d(e,"_getIonTilesetMetadata",(function(){return wr}))}])}));